<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¬æ½®é˜-äº‹ä¸šä¸€éƒ¨ - è‰ºäººä¿¡æ¯ç³»ç»Ÿ</title>
    <!-- å¼•å…¥RelationManagerç»„ä»¶æ ·å¼ -->
    <link rel="stylesheet" href="/static/relation-manager.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.8rem;
            text-align: center;
            flex: 1;
        }

        .back-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-size: 1rem;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .container {
            max-width: 1600px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* ç­›é€‰åŒºåŸŸæ ·å¼ */
        .filter-section {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 150px;
        }

        .filter-group label {
            font-size: 0.85rem;
            color: #657786;
            font-weight: 500;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .range-inputs {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .range-inputs input {
            width: 80px;
        }

        .range-inputs span {
            color: #657786;
            font-size: 0.9rem;
        }

        /* æ“ä½œæ—¥å¿—æ ·å¼ */
        .logs-container {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .operation-logs {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .log-item {
            background: white;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .log-operator {
            font-weight: 600;
            color: #667eea;
        }

        .log-time {
            font-size: 0.85rem;
            color: #657786;
        }

        .log-type {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .log-type.æ–°å¢ {
            background: #e3f2fd;
            color: #1976d2;
        }

        .log-type.ä¿®æ”¹ {
            background: #fff3e0;
            color: #f57c00;
        }

        .log-type.åˆ é™¤ {
            background: #ffebee;
            color: #d32f2f;
        }

        .log-content {
            font-size: 0.9rem;
            color: #333;
        }

        .loading {
            text-align: center;
            color: #657786;
            padding: 20px;
            font-style: italic;
        }

        .no-logs {
            text-align: center;
            color: #657786;
            padding: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: #ff4757;
            color: white;
        }

        .btn-danger:hover {
            background: #ff6b81;
        }

        .btn-edit {
            background: #2ed573;
            color: white;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-view {
            background: #3742fa;
            color: white;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-delete {
            background: #ff4757;
            color: white;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        /* è·Ÿè¿›è®°å½•æ—¶é—´çº¿æ ·å¼ */
        .follow-up-timeline {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            max-height: 350px;
            overflow-y: auto;
        }

        .timeline-item {
            position: relative;
            padding-left: 25px;
            padding-bottom: 12px;
            padding-top: 8px;
            border-left: 2px solid #667eea;
            margin-left: 8px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -5px;
            top: 12px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
        }

        .timeline-content {
            background: white;
            padding: 10px 12px;
            border-radius: 6px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.08);
        }

        .timeline-operator {
            font-weight: 600;
            color: #667eea;
            font-size: 0.85rem;
            margin-bottom: 3px;
        }

        .timeline-text {
            color: #333;
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 5px;
            word-break: break-word;
        }

        .timeline-time {
            font-size: 0.75rem;
            color: #999;
        }

        .timeline-actions {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }

        .timeline-edit-btn {
            color: #667eea;
            cursor: pointer;
            font-size: 0.8rem;
            background: none;
            border: none;
            padding: 0;
        }

        .timeline-edit-btn:hover {
            text-decoration: underline;
        }

        .timeline-delete {
            float: right;
            color: #ff4757;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .add-follow-up-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }

        .add-follow-up-form input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .add-follow-up-form button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .add-follow-up-form button:hover {
            background: #5568d3;
        }

        .artists-table {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            overflow-x: auto;
            /* ç¡®ä¿æ°´å¹³æ»šåŠ¨æ¡å§‹ç»ˆæ˜¾ç¤º */
            scrollbar-width: thin;
            scrollbar-color: #c1c8cd transparent;
            /* é’ˆå¯¹MacOSå¼ºåˆ¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */
            -webkit-overflow-scrolling: touch;
        }
        
        /* å…¨å±€å¼ºåˆ¶æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼ˆé’ˆå¯¹MacOSçš„WebKitæµè§ˆå™¨ï¼‰ */
        .artists-table {
            /* å¼ºåˆ¶æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œä¸è‡ªåŠ¨éšè— */
            scrollbar-gutter: stable both-edges;
        }
        
        /* WebKitæµè§ˆå™¨ï¼ˆChrome, Safariï¼‰ */
        .artists-table::-webkit-scrollbar {
            height: 8px;
            /* å¼ºåˆ¶æ˜¾ç¤ºæ»šåŠ¨æ¡å®½åº¦ */
            display: block !important;
        }
        
        .artists-table::-webkit-scrollbar-track {
            background: #f1f3f4;
            border-radius: 4px;
        }
        
        .artists-table::-webkit-scrollbar-thumb {
            background: #c1c8cd;
            border-radius: 4px;
        }
        
        .artists-table::-webkit-scrollbar-thumb:hover {
            background: #a8b2bc;
        }
        
        /* ç¡®ä¿è¡¨æ ¼å®¹å™¨å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡åŒºåŸŸ */
        .artists-table {
            min-height: calc(100% + 8px);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 2000px;
        }

        thead {
            background: #f8f9fa;
            position: sticky;
            top: 0;
        }

        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #e1e8ed;
            font-size: 0.85rem;
            white-space: nowrap;
        }

        th {
            font-weight: 600;
            color: #2c3e50;
        }

        tbody tr {
            transition: background 0.2s;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 1200px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            position: sticky;
            top: 0;
            background: white;
            padding-bottom: 20px;
            border-bottom: 2px solid #e1e8ed;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            color: #2c3e50;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #95a5a6;
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: #2c3e50;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .form-section h3 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e1e8ed;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 10px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group.half-width {
            grid-column: span 1;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid #e1e8ed;
            position: sticky;
            bottom: 0;
            background: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #95a5a6;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .actions {
            display: flex;
            gap: 5px;
            white-space: nowrap;
        }

        .tag {
            display: inline-block;
            padding: 3px 8px;
            background: #e1e8ed;
            border-radius: 6px;
            font-size: 0.75rem;
            color: #2c3e50;
            margin-right: 3px;
        }

        .scrollable-content {
            max-height: calc(90vh - 150px);
            overflow-y: auto;
            padding-right: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>å¬æ½®é˜-äº‹ä¸šä¸€éƒ¨<br>è‰ºäººç®¡ç†ç³»ç»Ÿ</h1>
        <a href="/" class="back-btn">è¿”å›é¦–é¡µ</a>
    </div>

    <div class="container">
        <div class="toolbar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="æœç´¢è‰ºäººå§“å/æŠ–éŸ³å·...">
            </div>
            <div class="filter-section">
                <!-- åŸºæœ¬ä¿¡æ¯ç­›é€‰ -->
                <div class="filter-group">
                    <label>å½“å‰çŠ¶æ€</label>
                    <select id="statusFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="æ´»è·ƒ">æ´»è·ƒ</option>
                        <option value="ä¼‘æ¯">ä¼‘æ¯</option>
                        <option value="æš‚åœ">æš‚åœ</option>
                        <option value="è§£çº¦">è§£çº¦</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>ç­¾çº¦ç±»å‹</label>
                    <select id="contractTypeFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="ç‹¬å®¶ç­¾çº¦">ç‹¬å®¶ç­¾çº¦</option>
                        <option value="éç‹¬å®¶">éç‹¬å®¶</option>
                        <option value="å…¼èŒ">å…¼èŒ</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ€§åˆ«</label>
                    <select id="genderFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="ç”·">ç”·</option>
                        <option value="å¥³">å¥³</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ°‘æ—</label>
                    <select id="ethnicityFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="æ±‰æ—">æ±‰æ—</option>
                        <option value="è’™å¤æ—">è’™å¤æ—</option>
                        <option value="å›æ—">å›æ—</option>
                        <option value="è—æ—">è—æ—</option>
                        <option value="ç»´å¾å°”æ—">ç»´å¾å°”æ—</option>
                        <option value="è‹—æ—">è‹—æ—</option>
                        <option value="å½æ—">å½æ—</option>
                        <option value="å£®æ—">å£®æ—</option>
                        <option value="å¸ƒä¾æ—">å¸ƒä¾æ—</option>
                        <option value="æœé²œæ—">æœé²œæ—</option>
                        <option value="æ»¡æ—">æ»¡æ—</option>
                        <option value="ä¾—æ—">ä¾—æ—</option>
                        <option value="ç‘¶æ—">ç‘¶æ—</option>
                        <option value="ç™½æ—">ç™½æ—</option>
                        <option value="åœŸå®¶æ—">åœŸå®¶æ—</option>
                        <option value="å“ˆå°¼æ—">å“ˆå°¼æ—</option>
                        <option value="å“ˆè¨å…‹æ—">å“ˆè¨å…‹æ—</option>
                        <option value="å‚£æ—">å‚£æ—</option>
                        <option value="é»æ—">é»æ—</option>
                        <option value="å‚ˆåƒ³æ—">å‚ˆåƒ³æ—</option>
                        <option value="ä½¤æ—">ä½¤æ—</option>
                        <option value="ç•²æ—">ç•²æ—</option>
                        <option value="é«˜å±±æ—">é«˜å±±æ—</option>
                        <option value="æ‹‰ç¥œæ—">æ‹‰ç¥œæ—</option>
                        <option value="æ°´æ—">æ°´æ—</option>
                        <option value="ä¸œä¹¡æ—">ä¸œä¹¡æ—</option>
                        <option value="çº³è¥¿æ—">çº³è¥¿æ—</option>
                        <option value="æ™¯é¢‡æ—">æ™¯é¢‡æ—</option>
                        <option value="æŸ¯å°”å…‹å­œæ—">æŸ¯å°”å…‹å­œæ—</option>
                        <option value="åœŸæ—">åœŸæ—</option>
                        <option value="è¾¾æ–¡å°”æ—">è¾¾æ–¡å°”æ—</option>
                        <option value="ä»«ä½¬æ—">ä»«ä½¬æ—</option>
                        <option value="ç¾Œæ—">ç¾Œæ—</option>
                        <option value="å¸ƒæœ—æ—">å¸ƒæœ—æ—</option>
                        <option value="æ’’æ‹‰æ—">æ’’æ‹‰æ—</option>
                        <option value="æ¯›å—æ—">æ¯›å—æ—</option>
                        <option value="ä»¡ä½¬æ—">ä»¡ä½¬æ—</option>
                        <option value="é”¡ä¼¯æ—">é”¡ä¼¯æ—</option>
                        <option value="é˜¿æ˜Œæ—">é˜¿æ˜Œæ—</option>
                        <option value="æ™®ç±³æ—">æ™®ç±³æ—</option>
                        <option value="å¡”å‰å…‹æ—">å¡”å‰å…‹æ—</option>
                        <option value="æ€’æ—">æ€’æ—</option>
                        <option value="ä¹Œå­œåˆ«å…‹æ—">ä¹Œå­œåˆ«å…‹æ—</option>
                        <option value="ä¿„ç½—æ–¯æ—">ä¿„ç½—æ–¯æ—</option>
                        <option value="é„‚æ¸©å…‹æ—">é„‚æ¸©å…‹æ—</option>
                        <option value="å¾·æ˜‚æ—">å¾·æ˜‚æ—</option>
                        <option value="ä¿å®‰æ—">ä¿å®‰æ—</option>
                        <option value="è£•å›ºæ—">è£•å›ºæ—</option>
                        <option value="äº¬æ—">äº¬æ—</option>
                        <option value="å¡”å¡”å°”æ—">å¡”å¡”å°”æ—</option>
                        <option value="ç‹¬é¾™æ—">ç‹¬é¾™æ—</option>
                        <option value="é„‚ä¼¦æ˜¥æ—">é„‚ä¼¦æ˜¥æ—</option>
                        <option value="èµ«å“²æ—">èµ«å“²æ—</option>
                        <option value="é—¨å·´æ—">é—¨å·´æ—</option>
                        <option value="çå·´æ—">çå·´æ—</option>
                        <option value="åŸºè¯ºæ—">åŸºè¯ºæ—</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>å”±åŠŸ</label>
                    <select id="vocalSkillFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="ä¸“ä¸š">ä¸“ä¸š</option>
                        <option value="ä¼˜ç§€">ä¼˜ç§€</option>
                        <option value="è‰¯å¥½">è‰¯å¥½</option>
                        <option value="ä¸€èˆ¬">ä¸€èˆ¬</option>
                        <option value="å…¥é—¨">å…¥é—¨</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>ç›´æ’­æ•ˆæœç­‰çº§</label>
                    <select id="liveEffectFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="Sçº§">Sçº§</option>
                        <option value="Açº§">Açº§</option>
                        <option value="Bçº§">Bçº§</option>
                        <option value="Cçº§">Cçº§</option>
                        <option value="Dçº§">Dçº§</option>
                    </select>
                </div>
                
                <!-- èŒä¸šä¿¡æ¯ç­›é€‰ -->
                <div class="filter-group">
                    <label>èŒä¸š</label>
                    <select id="occupationFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="æ­Œæ‰‹">æ­Œæ‰‹</option>
                        <option value="ä¸»æ’­">ä¸»æ’­</option>
                        <option value="æ¼”å‘˜">æ¼”å‘˜</option>
                        <option value="èˆè€…">èˆè€…</option>
                        <option value="æ¨¡ç‰¹">æ¨¡ç‰¹</option>
                        <option value="ä¸»æŒäºº">ä¸»æŒäºº</option>
                        <option value="éŸ³ä¹äºº">éŸ³ä¹äºº</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ›²é£</label>
                    <select id="musicStyleFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="æµè¡Œ">æµè¡Œ</option>
                        <option value="æ‘‡æ»š">æ‘‡æ»š</option>
                        <option value="æ°‘è°£">æ°‘è°£</option>
                        <option value="ç”µå­">ç”µå­</option>
                        <option value="å˜»å“ˆ">å˜»å“ˆ</option>
                        <option value="å¤å…¸">å¤å…¸</option>
                        <option value="çˆµå£«">çˆµå£«</option>
                        <option value="R&B">R&B</option>
                        <option value="ä¹¡æ‘">ä¹¡æ‘</option>
                        <option value="å¤é£">å¤é£</option>
                        <option value="é‡‘å±">é‡‘å±</option>
                        <option value="è“è°ƒ">è“è°ƒ</option>
                        <option value="é›·é¬¼">é›·é¬¼</option>
                        <option value="æœ‹å…‹">æœ‹å…‹</option>
                        <option value="æ‹‰ä¸">æ‹‰ä¸</option>
                    </select>
                </div>
                
                <!-- ä¸ªäººä¿¡æ¯ç­›é€‰ -->
                <div class="filter-group">
                    <label>MBTI</label>
                    <select id="mbtiFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="ISTJ">ISTJ</option>
                        <option value="ISFJ">ISFJ</option>
                        <option value="INFJ">INFJ</option>
                        <option value="INTJ">INTJ</option>
                        <option value="ISTP">ISTP</option>
                        <option value="ISFP">ISFP</option>
                        <option value="INFP">INFP</option>
                        <option value="INTP">INTP</option>
                        <option value="ESTP">ESTP</option>
                        <option value="ESFP">ESFP</option>
                        <option value="ENFP">ENFP</option>
                        <option value="ENTP">ENTP</option>
                        <option value="ESTJ">ESTJ</option>
                        <option value="ESFJ">ESFJ</option>
                        <option value="ENFJ">ENFJ</option>
                        <option value="ENTJ">ENTJ</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ„Ÿæƒ…æƒ…å†µ</label>
                    <select id="relationshipFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="å•èº«">å•èº«</option>
                        <option value="æ‹çˆ±ä¸­">æ‹çˆ±ä¸­</option>
                        <option value="å·²å©š">å·²å©š</option>
                        <option value="ç¦»å¼‚">ç¦»å¼‚</option>
                        <option value="ä¸§å¶">ä¸§å¶</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ€§æ ¼</label>
                    <select id="personalityFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="å¼€æœ—">å¼€æœ—</option>
                        <option value="å†…å‘">å†…å‘</option>
                        <option value="æ´»æ³¼">æ´»æ³¼</option>
                        <option value="æ²‰ç¨³">æ²‰ç¨³</option>
                        <option value="çƒ­æƒ…">çƒ­æƒ…</option>
                        <option value="å†·é™">å†·é™</option>
                        <option value="å¹½é»˜">å¹½é»˜</option>
                        <option value="ä¸¥è‚ƒ">ä¸¥è‚ƒ</option>
                        <option value="æ¸©æŸ”">æ¸©æŸ”</option>
                        <option value="å¼ºåŠ¿">å¼ºåŠ¿</option>
                        <option value="ç»†è…»">ç»†è…»</option>
                        <option value="è±ªçˆ½">è±ªçˆ½</option>
                        <option value="æ•æ„Ÿ">æ•æ„Ÿ</option>
                        <option value="å¤§å¤§å’§å’§">å¤§å¤§å’§å’§</option>
                        <option value="å®‰é™">å®‰é™</option>
                        <option value="å¤–å‘">å¤–å‘</option>
                        <option value="ç‹¬ç«‹">ç‹¬ç«‹</option>
                        <option value="ä¾èµ–">ä¾èµ–</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>æ˜¯å¦æ„¿æ„çº¿ä¸‹</label>
                    <select id="offlineWillingFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="æ˜¯">æ˜¯</option>
                        <option value="å¦">å¦</option>
                    </select>
                </div>
                
                <!-- æ‹›å‹Ÿä¿¡æ¯ç­›é€‰ -->
                <div class="filter-group">
                    <label>æ‹›å‹Ÿäºº</label>
                    <input type="text" id="recruiterFilter" placeholder="è¯·è¾“å…¥æ‹›å‹Ÿäºº">
                </div>
                <div class="filter-group">
                    <label>æ‹›å‹ŸçŠ¶æ€</label>
                    <select id="recruitmentStatusFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="è·Ÿè¿›ä¸­">è·Ÿè¿›ä¸­</option>
                        <option value="å·²ç­¾çº¦">å·²ç­¾çº¦</option>
                        <option value="ç­‰å¾…ç­¾çº¦">ç­‰å¾…ç­¾çº¦</option>
                        <option value="ç­¾çº¦å¤±è´¥">ç­¾çº¦å¤±è´¥</option>
                    </select>
                </div>
                
                <!-- æ•°å€¼èŒƒå›´ç­›é€‰ -->
                <div class="filter-group">
                    <label>ä½“é‡èŒƒå›´ (kg)</label>
                    <div class="range-inputs">
                        <input type="number" id="weightMin" placeholder="æœ€å°å€¼" min="0" step="0.1">
                        <span>-</span>
                        <input type="number" id="weightMax" placeholder="æœ€å¤§å€¼" min="0" step="0.1">
                    </div>
                </div>
                <div class="filter-group">
                    <label>èº«é«˜èŒƒå›´ (cm)</label>
                    <div class="range-inputs">
                        <input type="number" id="heightMin" placeholder="æœ€å°å€¼" min="0" step="0.1">
                        <span>-</span>
                        <input type="number" id="heightMax" placeholder="æœ€å¤§å€¼" min="0" step="0.1">
                    </div>
                </div>
                <div class="filter-group">
                    <label>æ€»æµæ°´èŒƒå›´ (å…ƒ)</label>
                    <div class="range-inputs">
                        <input type="number" id="revenueMin" placeholder="æœ€å°å€¼" min="0" step="1000">
                        <span>-</span>
                        <input type="number" id="revenueMax" placeholder="æœ€å¤§å€¼" min="0" step="1000">
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="resetFilters()">é‡ç½®ç­›é€‰</button>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="openModal()">æ–°å¢è‰ºäºº</button>
                <button class="btn btn-success" onclick="openBulkUploadModal()">æ‰¹é‡ä¸Šä¼ </button>
                <a href="/api/artists/template" class="btn btn-info" download="è‰ºäººä¿¡æ¯æ¨¡æ¿.csv">ä¸‹è½½æ¨¡æ¿</a>
            </div>
        </div>

        <div class="artists-table">
            <table>
                <thead>
                        <tr>
                            <th>æ“ä½œ</th>
                            <th>ID</th>
                            <th>è‰ºå</th>
                            <th>æŠ–éŸ³å·</th>
                            <th>å”±åŠŸ</th>
                            <th>ç›´æ’­æ•ˆæœç­‰çº§</th>
                            <th>æ€»æµæ°´(å…ƒ)</th>
                            <th>å½“å‰çŠ¶æ€</th>
                            <th>ç­¾çº¦ç±»å‹</th>
                            <th>ä½å€</th>
                            <th>èº«é«˜</th>
                            <th>ä½“é‡</th>
                            <th>ç”Ÿæ—¥</th>
                            <th>MBTI</th>
                            <th>æŠ€èƒ½</th>
                            <th>æ›²é£</th>
                            <th>å‚ä¸é¡¹ç›®</th>
                            <th>å‚ä¸æ´»åŠ¨</th>
                        </tr>
                    </thead>
                <tbody id="artistsList">
                </tbody>
            </table>
            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-state-icon">ğŸ­</div>
                <h3>æš‚æ— è‰ºäººæ•°æ®</h3>
                <p>ç‚¹å‡»"æ–°å¢è‰ºäºº"æŒ‰é’®å¼€å§‹æ·»åŠ </p>
            </div>
        </div>
    </div>

    <!-- æ–°å¢/ç¼–è¾‘è‰ºäººæ¨¡æ€æ¡† -->
    <div id="artistModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">æ–°å¢è‰ºäºº</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="artistForm">
                <input type="hidden" id="artistId">

                <div class="scrollable-content">
                    <!-- åŸºæœ¬ä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>åŸºæœ¬ä¿¡æ¯</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="name">è‰ºå *</label>
                                <input type="text" id="name" required>
                            </div>
                            <div class="form-group">
                                <label for="realName">çœŸå</label>
                                <input type="text" id="realName">
                            </div>
                            <div class="form-group">
                                <label for="douyinAccount">æŠ–éŸ³å·</label>
                                <input type="text" id="douyinAccount">
                            </div>
                            <div class="form-group">
                                <label for="gender">æ€§åˆ«</label>
                                <select id="gender">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="ç”·">ç”·</option>
                                    <option value="å¥³">å¥³</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="ethnicity">æ°‘æ—</label>
                                <input type="text" id="ethnicity">
                            </div>
                            <div class="form-group">
                                <label for="artMajor">è‰ºæœ¯ä¸“ä¸š</label>
                                <input type="text" id="artMajor">
                            </div>
                            <div class="form-group">
                                <label for="height">èº«é«˜(cm)</label>
                                <input type="text" id="height" placeholder="å¦‚ï¼š175.50">
                            </div>
                            <div class="form-group">
                                <label for="weight">ä½“é‡(kg)</label>
                                <input type="text" id="weight" placeholder="å¦‚ï¼š65.80">
                            </div>
                            <div class="form-group">
                                <label for="birthDate">ç”Ÿæ—¥</label>
                                <input type="date" id="birthDate">
                            </div>
                            <div class="form-group">
                                <label for="joinDate">å…¥ä¼šæ—¶é—´</label>
                                <input type="date" id="joinDate">
                            </div>
                        </div>
                    </div>

                    <!-- è”ç³»æ–¹å¼ -->
                    <div class="form-section">
                        <h3>è”ç³»æ–¹å¼</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="phone">æ‰‹æœºå·ç </label>
                                <input type="text" id="phone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç ">
                            </div>
                            <div class="form-group">
                                <label for="wechat">å¾®ä¿¡å·</label>
                                <input type="text" id="wechat" placeholder="è¯·è¾“å…¥å¾®ä¿¡å·">
                            </div>
                        </div>
                    </div>

                    <!-- æ‹›å‹Ÿä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>æ‹›å‹Ÿä¿¡æ¯</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="recruiter">æ‹›å‹Ÿäºº</label>
                                <input type="text" id="recruiter" readonly placeholder="è‡ªåŠ¨è·å–å½“å‰ç”¨æˆ·">
                            </div>
                            <div class="form-group">
                                <label for="recruitmentStatus">æ‹›å‹ŸçŠ¶æ€</label>
                                <select id="recruitmentStatus">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="è·Ÿè¿›ä¸­">è·Ÿè¿›ä¸­</option>
                                    <option value="å·²ç­¾çº¦">å·²ç­¾çº¦</option>
                                    <option value="ç­‰å¾…ç­¾çº¦">ç­‰å¾…ç­¾çº¦</option>
                                    <option value="ç­¾çº¦å¤±è´¥">ç­¾çº¦å¤±è´¥</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- èŒä¸šä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>èŒä¸šä¿¡æ¯</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="vocalSkill">å”±åŠŸ</label>
                                <input type="text" id="vocalSkill" placeholder="å¦‚ï¼šSçº§/Açº§/Bçº§">
                            </div>
                            <div class="form-group">
                                <label for="liveEffectLevel">ç›´æ’­æ•ˆæœç­‰çº§</label>
                                <input type="text" id="liveEffectLevel" placeholder="å¦‚ï¼šä¸€çº§/äºŒçº§/ä¸‰çº§">
                            </div>
                            <div class="form-group">
                                <label for="totalRevenue">æ€»æµæ°´(å…ƒ)ä¸Šæœˆ</label>
                                <input type="text" id="totalRevenue" placeholder="å¦‚ï¼š10000.50">
                            </div>
                            <div class="form-group">
                                <label for="currentStatus">å½“å‰çŠ¶æ€</label>
                                <input type="text" id="currentStatus" placeholder="å¦‚ï¼šåœ¨æ’­/ä¼‘æ¯/å®ä¹ ">
                            </div>
                            <div class="form-group">
                                <label for="contractType">ç­¾çº¦ç±»å‹</label>
                                <input type="text" id="contractType" placeholder="å¦‚ï¼šç‹¬å®¶/éç‹¬å®¶">
                            </div>
                            <div class="form-group">
                                <label for="occupation">èŒä¸š</label>
                                <input type="text" id="occupation" placeholder="å¦‚ï¼šæ­Œæ‰‹/ä¸»æ’­">
                            </div>
                            <div class="form-group">
                                <label for="musicStyle">æ›²é£</label>
                                <input type="text" id="musicStyle" placeholder="å¦‚ï¼šæµè¡Œ/æ‘‡æ»š/æ°‘è°£">
                            </div>
                            <div class="form-group">
                                <label for="fanName">ç²‰ä¸å</label>
                                <input type="text" id="fanName">
                            </div>
                        </div>
                    </div>

                    <!-- ä¸ªäººä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>ä¸ªäººä¿¡æ¯</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="relationshipStatus">æ„Ÿæƒ…æƒ…å†µ</label>
                                <input type="text" id="relationshipStatus" placeholder="å¦‚ï¼šå•èº«/æ‹çˆ±/å·²å©š">
                            </div>
                            <div class="form-group">
                                <label for="personality">æ€§æ ¼</label>
                                <input type="text" id="personality">
                            </div>
                            <div class="form-group">
                                <label for="mbti">MBTI</label>
                                <input type="text" id="mbti" maxlength="4" placeholder="å¦‚ï¼šINTJ/ENFP">
                            </div>
                            <div class="form-group">
                <label for="addressProvince">ä½å€ - çœ</label>
                <select id="addressProvince" onchange="updateCities('address')"></select>
            </div>
            <div class="form-group">
                <label for="addressCity">ä½å€ - å¸‚</label>
                <select id="addressCity"></select>
            </div>
            <div class="form-group">
                <label for="householdProvince">æˆ·ç±åœ° - çœ</label>
                <select id="householdProvince" onchange="updateCities('household')"></select>
            </div>
            <div class="form-group">
                <label for="householdCity">æˆ·ç±åœ° - å¸‚</label>
                <select id="householdCity"></select>
            </div>
                            <div class="form-group">
                                <label for="willingOffline">æ˜¯å¦æ„¿æ„çº¿ä¸‹</label>
                                <select id="willingOffline">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="æ˜¯">æ˜¯</option>
                                    <option value="å¦">å¦</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exposureParts">å¯éœ²å‡ºéƒ¨åˆ†</label>
                                <input type="text" id="exposureParts">
                            </div>
                            <div class="form-group">
                                <label for="singerAttachment">æ­Œæ‰‹å½±åƒ</label>
                                <input type="file" id="singerAttachment" accept="image/*,video/*" multiple>
                                <div id="mediaPreview" style="margin-top: 15px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- å…¶ä»–ä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>å…¶ä»–ä¿¡æ¯</h3>
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label for="skills">æŠ€èƒ½</label>
                                <textarea id="skills" rows="2" placeholder="å¦‚ï¼šé’¢ç´ã€å‰ä»–ã€èˆè¹ˆç­‰"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label for="expectation">æœŸæœ›</label>
                                <textarea id="expectation" rows="2"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label for="bond">ç¾ç»Š</label>
                                <textarea id="bond" rows="2"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label for="remarks">å¤‡æ³¨ä¿¡æ¯</label>
                                <textarea id="remarks" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæ—¥å¿— -->
                    <div class="form-section">
                        <h3>æ“ä½œæ—¥å¿—</h3>
                        <div class="logs-container">
                            <div id="operationLogs" class="operation-logs">
                                <!-- æ—¥å¿—å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                                <div class="loading">åŠ è½½æ—¥å¿—ä¸­...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()">å…³é—­</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- åª’ä½“é¢„è§ˆæ¨¡æ€æ¡† -->
    <div id="mediaPreviewModal" class="modal" style="display: none; z-index: 2000;">
        <div class="modal-content" style="max-width: 90%; max-height: 90%; padding: 0; overflow: hidden; background: #000;">
            <div style="position: absolute; top: 10px; right: 10px; z-index: 10;">
                <button class="btn btn-danger" onclick="closeMediaPreview()" style="background: rgba(255, 71, 87, 0.9); border: none; padding: 8px 16px; border-radius: 4px; color: white; cursor: pointer; font-size: 14px;">
                    å…³é—­
                </button>
            </div>
            <div id="mediaPreviewContent" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
            </div>
        </div>
    </div>

    <!-- è‰ºäººè¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="artistDetailModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>è‰ºäººè¯¦æƒ…</h2>
                <button class="close-btn" onclick="closeArtistDetailModal()">&times;</button>
            </div>
            <div class="scrollable-content">
                <!-- åŸºæœ¬ä¿¡æ¯ -->
                <div class="form-section">
                    <h3>åŸºæœ¬ä¿¡æ¯</h3>
                    <div class="info-grid" id="detailBasicInfo">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <!-- è”ç³»æ–¹å¼ -->
                <div class="form-section">
                    <h3>è”ç³»æ–¹å¼</h3>
                    <div class="info-grid" id="detailContactInfo">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <!-- æ‹›å‹Ÿä¿¡æ¯ -->
                <div class="form-section">
                    <h3>æ‹›å‹Ÿä¿¡æ¯</h3>
                    <div class="info-grid" id="detailRecruitmentInfo">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <!-- è·Ÿè¿›è®°å½• -->
                <div class="form-section">
                    <h3>å·¥å•è®°å½• <span style="font-size: 0.8rem; color: #999; font-weight: normal;">(æœ€æ–°5æ¡)</span></h3>
                    <div class="follow-up-timeline" id="followUpTimeline">
                        <div class="no-logs">æš‚æ— è·Ÿè¿›è®°å½•</div>
                    </div>
                    <div class="add-follow-up-form">
                        <input type="text" id="followUpOperator" readonly placeholder="æ“ä½œäºº">
                        <input type="text" id="newFollowUpContent" placeholder="è·Ÿè¿›è®°å½•å†…å®¹..." style="flex: 1;">
                        <button onclick="addFollowUp()">æ·»åŠ </button>
                    </div>
                </div>
                
                <!-- è¡Œç¨‹ç®¡ç† -->
                <div class="form-section">
                    <h3>è¡Œç¨‹ç®¡ç† <span style="font-size: 0.8rem; color: #999; font-weight: normal;">(æœ€æ–°10æ¡)</span></h3>
                    <div class="schedule-section">
                        <div class="schedule-tabs">
                            <button class="tab-btn active" onclick="switchScheduleTab('list', this)">è¡Œç¨‹åˆ—è¡¨</button>
                            <button class="tab-btn" onclick="switchScheduleTab('monthly', this)">æœˆåº¦è§†å›¾</button>
                        </div>
                        
                        <!-- è¡Œç¨‹åˆ—è¡¨è§†å›¾ -->
                        <div id="scheduleListView" class="schedule-view active">
                            <div class="schedule-list" id="scheduleList">
                                <div class="no-schedule">æš‚æ— è¡Œç¨‹è®°å½•</div>
                            </div>
                        </div>
                        
                        <!-- æœˆåº¦è§†å›¾ -->
                        <div id="scheduleMonthlyView" class="schedule-view">
                            <div class="monthly-calendar" id="monthlyCalendar">
                                <!-- åŠ¨æ€ç”Ÿæˆæ—¥å† -->
                            </div>
                        </div>
                        
                        <!-- è¡Œç¨‹ç»Ÿè®¡ -->
                        <div class="schedule-stats">
                            <div class="stat-item">
                                <span class="stat-label">æ€»è¡Œç¨‹æ•°</span>
                                <span class="stat-value" id="totalScheduleCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">é¡¹ç›®æ•°é‡</span>
                                <span class="stat-value" id="projectScheduleCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">æ´»åŠ¨æ•°é‡</span>
                                <span class="stat-value" id="activityScheduleCount">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ“ä½œäººç¡®è®¤æ¨¡æ€æ¡† -->
    <div id="operatorModal" class="modal" style="display: none; z-index: 3000;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2>æ“ä½œç¡®è®¤</h2>
                <button class="close-btn" onclick="closeOperatorModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="operatorName">è¯·è¾“å…¥æ“ä½œäººå§“å</label>
                    <input type="text" id="operatorName" placeholder="æ“ä½œäººå§“å" required>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeOperatorModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="confirmOperator()">ç¡®è®¤</button>
            </div>
        </div>
    </div>
    
    <!-- æ‰¹é‡ä¸Šä¼ æ¨¡æ€æ¡† -->
    <div id="bulkUploadModal" class="modal" style="display: none; z-index: 2000;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>æ‰¹é‡ä¸Šä¼ è‰ºäººä¿¡æ¯</h2>
                <button class="close-btn" onclick="closeBulkUploadModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="bulkFile">é€‰æ‹©CSVæ–‡ä»¶</label>
                    <input type="file" id="bulkFile" accept=".csv" required>
                    <small>è¯·ä½¿ç”¨æä¾›çš„æ¨¡æ¿æ–‡ä»¶ï¼Œç¡®ä¿æ ¼å¼æ­£ç¡®</small>
                </div>
                <div class="form-group">
                    <label for="bulkOperator">æ“ä½œäººå§“å</label>
                    <input type="text" id="bulkOperator" placeholder="è¯·è¾“å…¥æ“ä½œäººå§“å" required>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBulkUploadModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitBulkUpload()">ä¸Šä¼ </button>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†è‰ºäººé¡¹ç›®æ¨¡æ€æ¡† -->
    <div id="manageProjectsModal" class="modal" style="display: none; z-index: 2000;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="manageProjectsTitle">ç®¡ç†è‰ºäººé¡¹ç›®</h2>
                <button class="close-btn" onclick="closeManageProjectsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="currentArtistId">
                <div style="margin-bottom: 20px;">
                    <h3>å·²å‚ä¸é¡¹ç›®</h3>
                    <div id="artistProjectsList">
                        <!-- åŠ¨æ€ç”Ÿæˆå·²å‚ä¸é¡¹ç›®åˆ—è¡¨ -->
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3>æ·»åŠ æ–°é¡¹ç›®</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="projectSearch" placeholder="æœç´¢é¡¹ç›®æ ‡é¢˜..." style="flex: 1; padding: 10px; border: 2px solid #e1e8ed; border-radius: 8px;">
                        <button class="btn btn-primary" onclick="searchProjects()">æœç´¢</button>
                    </div>
                    <div id="projectSearchResults" style="max-height: 200px; overflow-y: auto; padding: 10px; background: #f8f9fa; border-radius: 8px;"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeManageProjectsModal()">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†è‰ºäººæ´»åŠ¨æ¨¡æ€æ¡† -->
    <div id="manageActivitiesModal" class="modal" style="display: none; z-index: 2000;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="manageActivitiesTitle">ç®¡ç†è‰ºäººæ´»åŠ¨</h2>
                <button class="close-btn" onclick="closeManageActivitiesModal()">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="currentArtistIdForActivities">
                <div style="margin-bottom: 20px;">
                    <h3>å·²å‚ä¸æ´»åŠ¨</h3>
                    <div id="artistActivitiesList">
                        <!-- åŠ¨æ€ç”Ÿæˆå·²å‚ä¸æ´»åŠ¨åˆ—è¡¨ -->
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3>æ·»åŠ æ–°æ´»åŠ¨</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="activitySearch" placeholder="æœç´¢æ´»åŠ¨æ ‡é¢˜..." style="flex: 1; padding: 10px; border: 2px solid #e1e8ed; border-radius: 8px;">
                        <button class="btn btn-primary" onclick="searchActivities()">æœç´¢</button>
                    </div>
                    <div id="activitySearchResults" style="max-height: 200px; overflow-y: auto; padding: 10px; background: #f8f9fa; border-radius: 8px;"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeManageActivitiesModal()">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        let artists = [];
        
        // æ“ä½œäººç¡®è®¤ç›¸å…³å˜é‡
        let currentOperation = null;
        let currentOperationData = null;
        let currentOperator = '';
        let currentArtistId = null;
        
        // è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
        function getCurrentUser() {
            // ç®€åŒ–å®ç°ï¼Œä¸é˜»å¡é¡µé¢åŠ è½½
            fetch('/api/current-user')
                .then(function(response) {
                    if (response.ok) {
                        return response.json();
                    }
                    return { nickname: 'æœªçŸ¥ç”¨æˆ·' };
                })
                .then(function(data) {
                    currentOperator = data.nickname;
                })
                .catch(function(error) {
                    console.error('è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
                    currentOperator = 'æœªçŸ¥ç”¨æˆ·';
                });
        }

        // é¡µé¢åŠ è½½æ—¶è·å–è‰ºäººåˆ—è¡¨
        async function loadArtists() {
            try {
                const response = await fetch('/api/artists');
                const result = await response.json();
                if (result.success) {
                    artists = result.data;
                    renderArtists(artists);
                }
            } catch (error) {
                console.error('åŠ è½½è‰ºäººåˆ—è¡¨å¤±è´¥:', error);
                alert('åŠ è½½è‰ºäººåˆ—è¡¨å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }

        // æ¸²æŸ“è‰ºäººåˆ—è¡¨
        // åŠ è½½è‰ºäººè¯¦æƒ…ï¼ˆç”¨äºè·å–å…³è”çš„é¡¹ç›®å’Œæ´»åŠ¨ï¼‰
        async function loadArtistWithDetails(artistId) {
            try {
                const response = await fetch(`/api/artists/${artistId}`);
                const result = await response.json();
                if (result.success) {
                    return result.data;
                }
                return null;
            } catch (error) {
                console.error('åŠ è½½è‰ºäººè¯¦æƒ…å¤±è´¥:', error);
                return null;
            }
        }

        // æ¸²æŸ“å‚ä¸é¡¹ç›®åˆ—
        async function renderArtistProjects(artistId) {
            console.log(`å¼€å§‹æ¸²æŸ“è‰ºäºº ${artistId} çš„é¡¹ç›®`);
            const artist = await loadArtistWithDetails(artistId);
            console.log(`è·å–åˆ°çš„è‰ºäººæ•°æ®:`, artist);
            
            if (!artist) {
                console.log(`è‰ºäººæ•°æ®ä¸å­˜åœ¨`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            if (!artist.projects) {
                console.log(`è‰ºäººé¡¹ç›®æ•°ç»„ä¸å­˜åœ¨`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            if (artist.projects.length === 0) {
                console.log(`è‰ºäººé¡¹ç›®æ•°ç»„ä¸ºç©º`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            console.log(`è‰ºäººå‚ä¸çš„é¡¹ç›®æ•°é‡:`, artist.projects.length);
            return artist.projects.map(project => 
                `<span class="tag" style="margin-right: 5px; cursor: pointer; text-decoration: underline; color: #667eea;" onclick="window.location.href='/projects'; setTimeout(() => editProject(${project.id}), 500);">${project.title}</span>`
            ).join('');
        }

        // æ¸²æŸ“å‚ä¸æ´»åŠ¨åˆ—
        async function renderArtistActivities(artistId) {
            console.log(`å¼€å§‹æ¸²æŸ“è‰ºäºº ${artistId} çš„æ´»åŠ¨`);
            const artist = await loadArtistWithDetails(artistId);
            console.log(`è·å–åˆ°çš„è‰ºäººæ•°æ®:`, artist);
            
            if (!artist) {
                console.log(`è‰ºäººæ•°æ®ä¸å­˜åœ¨`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            if (!artist.activities) {
                console.log(`è‰ºäººæ´»åŠ¨æ•°ç»„ä¸å­˜åœ¨`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            if (artist.activities.length === 0) {
                console.log(`è‰ºäººæ´»åŠ¨æ•°ç»„ä¸ºç©º`);
                return '<span class="tag">0 ä¸ª</span>';
            }
            
            console.log(`è‰ºäººå‚ä¸çš„æ´»åŠ¨æ•°é‡:`, artist.activities.length);
            return artist.activities.map(activity => 
                `<span class="tag" style="margin-right: 5px; cursor: pointer; text-decoration: underline; color: #fa709a;" onclick="window.location.href='/activities'; setTimeout(() => editActivity(${activity.id}), 500);">${activity.title}</span>`
            ).join('');
        }

        function renderArtists(artistList) {
            const tbody = document.getElementById('artistsList');
            const emptyState = document.getElementById('emptyState');

            if (artistList.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            tbody.innerHTML = artistList.map(artist => `
                <tr data-id="${artist.id}">
                    <td>
                        <div class="actions">
                            <button class="btn btn-view" onclick="viewArtistDetail(${artist.id})">æ–°å¢å·¥å•</button>
                            <button class="btn btn-edit" onclick="editArtist(${artist.id})">ç¼–è¾‘</button>
                            <button class="btn btn-delete" onclick="deleteArtist(${artist.id})">åˆ é™¤</button>
                        </div>
                    </td>
                    <td>${artist.id}</td>
                    <td><a href="#" onclick="editArtist(${artist.id}); return false;" class="artist-name" style="text-decoration: underline; color: #667eea;"><strong>${artist.name}</strong></a></td>
                    <td>${artist.douyin_account || '-'}</td>
                    <td>${artist.vocal_skill || '-'}</td>
                    <td>${artist.live_effect_level || '-'}</td>
                    <td>${artist.total_revenue ? Number(artist.total_revenue).toLocaleString() : '-'}</td>
                    <td><span class="tag">${artist.current_status || '-'}</span></td>
                    <td>${artist.contract_type || '-'}</td>
                    <td>${artist.address || '-'}</td>
                    <td>${artist.height || '-'}</td>
                    <td>${artist.weight || '-'}</td>
                    <td>${formatDate(artist.birth_date)}</td>
                    <td>${artist.mbti || '-'}</td>
                    <td>${artist.skills || '-'}</td>
                    <td>${artist.music_style || '-'}</td>
                    <td id="projects-${artist.id}"><span class="tag">${artist.project_count || 0} ä¸ª</span></td>
                    <td id="activities-${artist.id}"><span class="tag">${artist.activity_count || 0} ä¸ª</span></td>
                </tr>
            `).join('');

            // å¼‚æ­¥åŠ è½½å¹¶æ¸²æŸ“å…·ä½“çš„é¡¹ç›®å’Œæ´»åŠ¨
            artistList.forEach(artist => {
                // æ¸²æŸ“å‚ä¸é¡¹ç›®
                renderArtistProjects(artist.id).then(html => {
                    const projectsCell = document.getElementById(`projects-${artist.id}`);
                    if (projectsCell) {
                        projectsCell.innerHTML = html;
                    }
                });
                // æ¸²æŸ“å‚ä¸æ´»åŠ¨
                renderArtistActivities(artist.id).then(html => {
                    const activitiesCell = document.getElementById(`activities-${artist.id}`);
                    if (activitiesCell) {
                        activitiesCell.innerHTML = html;
                    }
                });
            });
        }

        // çœå¸‚æ•°æ®
        const provincesCities = {
            'åŒ—äº¬å¸‚': ['ä¸œåŸåŒº', 'è¥¿åŸåŒº', 'æœé˜³åŒº', 'ä¸°å°åŒº', 'çŸ³æ™¯å±±åŒº', 'æµ·æ·€åŒº', 'é—¨å¤´æ²ŸåŒº', 'æˆ¿å±±åŒº', 'é€šå·åŒº', 'é¡ºä¹‰åŒº', 'æ˜Œå¹³åŒº', 'å¤§å…´åŒº', 'æ€€æŸ”åŒº', 'å¹³è°·åŒº', 'å¯†äº‘åŒº', 'å»¶åº†åŒº'],
            'ä¸Šæµ·å¸‚': ['é»„æµ¦åŒº', 'å¾æ±‡åŒº', 'é•¿å®åŒº', 'é™å®‰åŒº', 'æ™®é™€åŒº', 'è™¹å£åŒº', 'æ¨æµ¦åŒº', 'é—µè¡ŒåŒº', 'å®å±±åŒº', 'å˜‰å®šåŒº', 'æµ¦ä¸œæ–°åŒº', 'é‡‘å±±åŒº', 'æ¾æ±ŸåŒº', 'é’æµ¦åŒº', 'å¥‰è´¤åŒº', 'å´‡æ˜åŒº'],
            'å¤©æ´¥å¸‚': ['å’Œå¹³åŒº', 'æ²³ä¸œåŒº', 'æ²³è¥¿åŒº', 'å—å¼€åŒº', 'æ²³åŒ—åŒº', 'çº¢æ¡¥åŒº', 'ä¸œä¸½åŒº', 'è¥¿é’åŒº', 'æ´¥å—åŒº', 'åŒ—è¾°åŒº', 'æ­¦æ¸…åŒº', 'å®å»åŒº', 'æ»¨æµ·æ–°åŒº', 'å®æ²³åŒº', 'é™æµ·åŒº', 'è“Ÿå·åŒº'],
            'é‡åº†å¸‚': ['ä¸‡å·åŒº', 'é»”æ±ŸåŒº', 'æ¶ªé™µåŒº', 'æ¸ä¸­åŒº', 'å¤§æ¸¡å£åŒº', 'æ±ŸåŒ—åŒº', 'æ²™åªååŒº', 'ä¹é¾™å¡åŒº', 'å—å²¸åŒº', 'åŒ—ç¢šåŒº', 'æ¸åŒ—åŒº', 'å·´å—åŒº', 'é•¿å¯¿åŒº', 'æ±Ÿæ´¥åŒº', 'åˆå·åŒº', 'æ°¸å·åŒº', 'å—å·åŒº', 'ç¶¦æ±ŸåŒº', 'å¤§è¶³åŒº', 'ç’§å±±åŒº', 'é“œæ¢åŒº', 'æ½¼å—åŒº', 'è£æ˜ŒåŒº', 'å¼€å·åŒº', 'æ¢å¹³åŒº', 'æ­¦éš†åŒº', 'åŸå£å¿', 'ä¸°éƒ½å¿', 'å«æ±Ÿå¿', 'å¿ å¿', 'äº‘é˜³å¿', 'å¥‰èŠ‚å¿', 'å·«å±±å¿', 'å·«æºªå¿', 'çŸ³æŸ±åœŸå®¶æ—è‡ªæ²»å¿', 'ç§€å±±åœŸå®¶æ—è‹—æ—è‡ªæ²»å¿', 'é…‰é˜³åœŸå®¶æ—è‹—æ—è‡ªæ²»å¿', 'å½­æ°´è‹—æ—åœŸå®¶æ—è‡ªæ²»å¿'],
            'æ²³åŒ—çœ': ['çŸ³å®¶åº„å¸‚', 'å”å±±å¸‚', 'ç§¦çš‡å²›å¸‚', 'é‚¯éƒ¸å¸‚', 'é‚¢å°å¸‚', 'ä¿å®šå¸‚', 'å¼ å®¶å£å¸‚', 'æ‰¿å¾·å¸‚', 'æ²§å·å¸‚', 'å»ŠåŠå¸‚', 'è¡¡æ°´å¸‚'],
            'å±±è¥¿çœ': ['å¤ªåŸå¸‚', 'å¤§åŒå¸‚', 'é˜³æ³‰å¸‚', 'é•¿æ²»å¸‚', 'æ™‹åŸå¸‚', 'æœ”å·å¸‚', 'æ™‹ä¸­å¸‚', 'è¿åŸå¸‚', 'å¿»å·å¸‚', 'ä¸´æ±¾å¸‚', 'å•æ¢å¸‚'],
            'è¾½å®çœ': ['æ²ˆé˜³å¸‚', 'å¤§è¿å¸‚', 'éå±±å¸‚', 'æŠšé¡ºå¸‚', 'æœ¬æºªå¸‚', 'ä¸¹ä¸œå¸‚', 'é”¦å·å¸‚', 'è¥å£å¸‚', 'é˜œæ–°å¸‚', 'è¾½é˜³å¸‚', 'ç›˜é”¦å¸‚', 'é“å²­å¸‚', 'æœé˜³å¸‚', 'è‘«èŠ¦å²›å¸‚'],
            'å‰æ—çœ': ['é•¿æ˜¥å¸‚', 'å‰æ—å¸‚', 'å››å¹³å¸‚', 'è¾½æºå¸‚', 'é€šåŒ–å¸‚', 'ç™½å±±å¸‚', 'æ¾åŸå¸‚', 'ç™½åŸå¸‚', 'å»¶è¾¹æœé²œæ—è‡ªæ²»å·'],
            'é»‘é¾™æ±Ÿçœ': ['å“ˆå°”æ»¨å¸‚', 'é½é½å“ˆå°”å¸‚', 'é¸¡è¥¿å¸‚', 'é¹¤å²—å¸‚', 'åŒé¸­å±±å¸‚', 'å¤§åº†å¸‚', 'ä¼Šæ˜¥å¸‚', 'ä½³æœ¨æ–¯å¸‚', 'ä¸ƒå°æ²³å¸‚', 'ç‰¡ä¸¹æ±Ÿå¸‚', 'é»‘æ²³å¸‚', 'ç»¥åŒ–å¸‚', 'å¤§å…´å®‰å²­åœ°åŒº'],
            'æ±Ÿè‹çœ': ['å—äº¬å¸‚', 'æ— é”¡å¸‚', 'å¾å·å¸‚', 'å¸¸å·å¸‚', 'è‹å·å¸‚', 'å—é€šå¸‚', 'è¿äº‘æ¸¯å¸‚', 'æ·®å®‰å¸‚', 'ç›åŸå¸‚', 'æ‰¬å·å¸‚', 'é•‡æ±Ÿå¸‚', 'æ³°å·å¸‚', 'å®¿è¿å¸‚'],
            'æµ™æ±Ÿçœ': ['æ­å·å¸‚', 'å®æ³¢å¸‚', 'æ¸©å·å¸‚', 'å˜‰å…´å¸‚', 'æ¹–å·å¸‚', 'ç»å…´å¸‚', 'é‡‘åå¸‚', 'è¡¢å·å¸‚', 'èˆŸå±±å¸‚', 'å°å·å¸‚', 'ä¸½æ°´å¸‚'],
            'å®‰å¾½çœ': ['åˆè‚¥å¸‚', 'èŠœæ¹–å¸‚', 'èšŒåŸ å¸‚', 'æ·®å—å¸‚', 'é©¬éå±±å¸‚', 'æ·®åŒ—å¸‚', 'é“œé™µå¸‚', 'å®‰åº†å¸‚', 'é»„å±±å¸‚', 'æ»å·å¸‚', 'é˜œé˜³å¸‚', 'å®¿å·å¸‚', 'å…­å®‰å¸‚', 'äº³å·å¸‚', 'æ± å·å¸‚', 'å®£åŸå¸‚'],
            'ç¦å»ºçœ': ['ç¦å·å¸‚', 'å¦é—¨å¸‚', 'è†ç”°å¸‚', 'ä¸‰æ˜å¸‚', 'æ³‰å·å¸‚', 'æ¼³å·å¸‚', 'å—å¹³å¸‚', 'é¾™å²©å¸‚', 'å®å¾·å¸‚'],
            'æ±Ÿè¥¿çœ': ['å—æ˜Œå¸‚', 'æ™¯å¾·é•‡å¸‚', 'èä¹¡å¸‚', 'ä¹æ±Ÿå¸‚', 'æ–°ä½™å¸‚', 'é¹°æ½­å¸‚', 'èµ£å·å¸‚', 'å‰å®‰å¸‚', 'å®œæ˜¥å¸‚', 'æŠšå·å¸‚', 'ä¸Šé¥¶å¸‚'],
            'å±±ä¸œçœ': ['æµå—å¸‚', 'é’å²›å¸‚', 'æ·„åšå¸‚', 'æ£åº„å¸‚', 'ä¸œè¥å¸‚', 'çƒŸå°å¸‚', 'æ½åŠå¸‚', 'æµå®å¸‚', 'æ³°å®‰å¸‚', 'å¨æµ·å¸‚', 'æ—¥ç…§å¸‚', 'ä¸´æ²‚å¸‚', 'å¾·å·å¸‚', 'èŠåŸå¸‚', 'æ»¨å·å¸‚', 'èæ³½å¸‚'],
            'æ²³å—çœ': ['éƒ‘å·å¸‚', 'å¼€å°å¸‚', 'æ´›é˜³å¸‚', 'å¹³é¡¶å±±å¸‚', 'å®‰é˜³å¸‚', 'é¹¤å£å¸‚', 'æ–°ä¹¡å¸‚', 'ç„¦ä½œå¸‚', 'æ¿®é˜³å¸‚', 'è®¸æ˜Œå¸‚', 'æ¼¯æ²³å¸‚', 'ä¸‰é—¨å³¡å¸‚', 'å—é˜³å¸‚', 'å•†ä¸˜å¸‚', 'ä¿¡é˜³å¸‚', 'å‘¨å£å¸‚', 'é©»é©¬åº—å¸‚'],
            'æ¹–åŒ—çœ': ['æ­¦æ±‰å¸‚', 'é»„çŸ³å¸‚', 'åå °å¸‚', 'å®œæ˜Œå¸‚', 'è¥„é˜³å¸‚', 'é„‚å·å¸‚', 'è†é—¨å¸‚', 'å­æ„Ÿå¸‚', 'è†å·å¸‚', 'é»„å†ˆå¸‚', 'å’¸å®å¸‚', 'éšå·å¸‚', 'æ©æ–½åœŸå®¶æ—è‹—æ—è‡ªæ²»å·'],
            'æ¹–å—çœ': ['é•¿æ²™å¸‚', 'æ ªæ´²å¸‚', 'æ¹˜æ½­å¸‚', 'è¡¡é˜³å¸‚', 'é‚µé˜³å¸‚', 'å²³é˜³å¸‚', 'å¸¸å¾·å¸‚', 'å¼ å®¶ç•Œå¸‚', 'ç›Šé˜³å¸‚', 'éƒ´å·å¸‚', 'æ°¸å·å¸‚', 'æ€€åŒ–å¸‚', 'å¨„åº•å¸‚', 'æ¹˜è¥¿åœŸå®¶æ—è‹—æ—è‡ªæ²»å·'],
            'å¹¿ä¸œçœ': ['å¹¿å·å¸‚', 'éŸ¶å…³å¸‚', 'æ·±åœ³å¸‚', 'ç æµ·å¸‚', 'æ±•å¤´å¸‚', 'ä½›å±±å¸‚', 'æ±Ÿé—¨å¸‚', 'æ¹›æ±Ÿå¸‚', 'èŒ‚åå¸‚', 'è‚‡åº†å¸‚', 'æƒ å·å¸‚', 'æ¢…å·å¸‚', 'æ±•å°¾å¸‚', 'æ²³æºå¸‚', 'é˜³æ±Ÿå¸‚', 'æ¸…è¿œå¸‚', 'ä¸œèå¸‚', 'ä¸­å±±å¸‚', 'æ½®å·å¸‚', 'æ­é˜³å¸‚', 'äº‘æµ®å¸‚'],
            'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº': ['å—å®å¸‚', 'æŸ³å·å¸‚', 'æ¡‚æ—å¸‚', 'æ¢§å·å¸‚', 'åŒ—æµ·å¸‚', 'é˜²åŸæ¸¯å¸‚', 'é’¦å·å¸‚', 'è´µæ¸¯å¸‚', 'ç‰æ—å¸‚', 'ç™¾è‰²å¸‚', 'è´ºå·å¸‚', 'æ²³æ± å¸‚', 'æ¥å®¾å¸‚', 'å´‡å·¦å¸‚'],
            'æµ·å—çœ': ['æµ·å£å¸‚', 'ä¸‰äºšå¸‚', 'ä¸‰æ²™å¸‚', 'å„‹å·å¸‚'],
            'å››å·çœ': ['æˆéƒ½å¸‚', 'è‡ªè´¡å¸‚', 'æ”€æèŠ±å¸‚', 'æ³¸å·å¸‚', 'å¾·é˜³å¸‚', 'ç»µé˜³å¸‚', 'å¹¿å…ƒå¸‚', 'é‚å®å¸‚', 'å†…æ±Ÿå¸‚', 'ä¹å±±å¸‚', 'å—å……å¸‚', 'çœ‰å±±å¸‚', 'å®œå®¾å¸‚', 'å¹¿å®‰å¸‚', 'è¾¾å·å¸‚', 'é›…å®‰å¸‚', 'å·´ä¸­å¸‚', 'èµ„é˜³å¸‚', 'é˜¿åè—æ—ç¾Œæ—è‡ªæ²»å·', 'ç”˜å­œè—æ—è‡ªæ²»å·', 'å‡‰å±±å½æ—è‡ªæ²»å·'],
            'è´µå·çœ': ['è´µé˜³å¸‚', 'å…­ç›˜æ°´å¸‚', 'éµä¹‰å¸‚', 'å®‰é¡ºå¸‚', 'æ¯•èŠ‚å¸‚', 'é“œä»å¸‚', 'é»”è¥¿å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·', 'é»”ä¸œå—è‹—æ—ä¾—æ—è‡ªæ²»å·', 'é»”å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·'],
            'äº‘å—çœ': ['æ˜†æ˜å¸‚', 'æ›²é–å¸‚', 'ç‰æºªå¸‚', 'ä¿å±±å¸‚', 'æ˜­é€šå¸‚', 'ä¸½æ±Ÿå¸‚', 'æ™®æ´±å¸‚', 'ä¸´æ²§å¸‚', 'æ¥šé›„å½æ—è‡ªæ²»å·', 'çº¢æ²³å“ˆå°¼æ—å½æ—è‡ªæ²»å·', 'æ–‡å±±å£®æ—è‹—æ—è‡ªæ²»å·', 'è¥¿åŒç‰ˆçº³å‚£æ—è‡ªæ²»å·', 'å¤§ç†ç™½æ—è‡ªæ²»å·', 'å¾·å®å‚£æ—æ™¯é¢‡æ—è‡ªæ²»å·', 'æ€’æ±Ÿå‚ˆåƒ³æ—è‡ªæ²»å·', 'è¿ªåº†è—æ—è‡ªæ²»å·'],
            'è¥¿è—è‡ªæ²»åŒº': ['æ‹‰è¨å¸‚', 'æ—¥å–€åˆ™å¸‚', 'æ˜Œéƒ½å¸‚', 'æ—èŠå¸‚', 'å±±å—å¸‚', 'é‚£æ›²å¸‚', 'é˜¿é‡Œåœ°åŒº'],
            'é™•è¥¿çœ': ['è¥¿å®‰å¸‚', 'é“œå·å¸‚', 'å®é¸¡å¸‚', 'å’¸é˜³å¸‚', 'æ¸­å—å¸‚', 'å»¶å®‰å¸‚', 'æ±‰ä¸­å¸‚', 'æ¦†æ—å¸‚', 'å®‰åº·å¸‚', 'å•†æ´›å¸‚'],
            'ç”˜è‚ƒçœ': ['å…°å·å¸‚', 'å˜‰å³ªå…³å¸‚', 'é‡‘æ˜Œå¸‚', 'ç™½é“¶å¸‚', 'å¤©æ°´å¸‚', 'æ­¦å¨å¸‚', 'å¼ æ–å¸‚', 'å¹³å‡‰å¸‚', 'é…’æ³‰å¸‚', 'åº†é˜³å¸‚', 'å®šè¥¿å¸‚', 'é™‡å—å¸‚', 'ä¸´å¤å›æ—è‡ªæ²»å·', 'ç”˜å—è—æ—è‡ªæ²»å·'],
            'é’æµ·çœ': ['è¥¿å®å¸‚', 'æµ·ä¸œå¸‚', 'æµ·åŒ—è—æ—è‡ªæ²»å·', 'é»„å—è—æ—è‡ªæ²»å·', 'æµ·å—è—æ—è‡ªæ²»å·', 'æœæ´›è—æ—è‡ªæ²»å·', 'ç‰æ ‘è—æ—è‡ªæ²»å·', 'æµ·è¥¿è’™å¤æ—è—æ—è‡ªæ²»å·'],
            'å®å¤å›æ—è‡ªæ²»åŒº': ['é“¶å·å¸‚', 'çŸ³å˜´å±±å¸‚', 'å´å¿ å¸‚', 'å›ºåŸå¸‚', 'ä¸­å«å¸‚'],
            'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº': ['ä¹Œé²æœ¨é½å¸‚', 'å…‹æ‹‰ç›ä¾å¸‚', 'åé²ç•ªå¸‚', 'å“ˆå¯†å¸‚', 'æ˜Œå‰å›æ—è‡ªæ²»å·', 'åšå°”å¡”æ‹‰è’™å¤è‡ªæ²»å·', 'å·´éŸ³éƒ­æ¥è’™å¤è‡ªæ²»å·', 'é˜¿å…‹è‹åœ°åŒº', 'å…‹å­œå‹’è‹æŸ¯å°”å…‹å­œè‡ªæ²»å·', 'å–€ä»€åœ°åŒº', 'å’Œç”°åœ°åŒº', 'ä¼ŠçŠå“ˆè¨å…‹è‡ªæ²»å·', 'å¡”åŸåœ°åŒº', 'é˜¿å‹’æ³°åœ°åŒº'],
            'å†…è’™å¤è‡ªæ²»åŒº': ['å‘¼å’Œæµ©ç‰¹å¸‚', 'åŒ…å¤´å¸‚', 'ä¹Œæµ·å¸‚', 'èµ¤å³°å¸‚', 'é€šè¾½å¸‚', 'é„‚å°”å¤šæ–¯å¸‚', 'å‘¼ä¼¦è´å°”å¸‚', 'å·´å½¦æ·–å°”å¸‚', 'ä¹Œå…°å¯Ÿå¸ƒå¸‚', 'å…´å®‰ç›Ÿ', 'é”¡æ—éƒ­å‹’ç›Ÿ', 'é˜¿æ‹‰å–„ç›Ÿ'],
            'å°æ¹¾çœ': ['å°åŒ—å¸‚', 'æ–°åŒ—å¸‚', 'æ¡ƒå›­å¸‚', 'å°ä¸­å¸‚', 'å°å—å¸‚', 'é«˜é›„å¸‚', 'åŸºéš†å¸‚', 'æ–°ç«¹å¸‚', 'å˜‰ä¹‰å¸‚'],
            'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº': ['é¦™æ¸¯å²›', 'ä¹é¾™åŠå²›', 'æ–°ç•Œ'],
            'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº': ['æ¾³é—¨åŠå²›', 'æ°¹ä»”å²›', 'è·¯ç¯å²›']
        };

        // ä¸‹æ‹‰èœå•é€‰é¡¹æ•°æ®
        const dropdownOptions = {
            ethnicity: ['æ±‰æ—', 'è’™å¤æ—', 'å›æ—', 'è—æ—', 'ç»´å¾å°”æ—', 'è‹—æ—', 'å½æ—', 'å£®æ—', 'å¸ƒä¾æ—', 'æœé²œæ—', 'æ»¡æ—', 'ä¾—æ—', 'ç‘¶æ—', 'ç™½æ—', 'åœŸå®¶æ—', 'å“ˆå°¼æ—', 'å“ˆè¨å…‹æ—', 'å‚£æ—', 'é»æ—', 'å‚ˆåƒ³æ—', 'ä½¤æ—', 'ç•²æ—', 'é«˜å±±æ—', 'æ‹‰ç¥œæ—', 'æ°´æ—', 'ä¸œä¹¡æ—', 'çº³è¥¿æ—', 'æ™¯é¢‡æ—', 'æŸ¯å°”å…‹å­œæ—', 'åœŸæ—', 'è¾¾æ–¡å°”æ—', 'ä»«ä½¬æ—', 'ç¾Œæ—', 'å¸ƒæœ—æ—', 'æ’’æ‹‰æ—', 'æ¯›å—æ—', 'ä»¡ä½¬æ—', 'é”¡ä¼¯æ—', 'é˜¿æ˜Œæ—', 'æ™®ç±³æ—', 'å¡”å‰å…‹æ—', 'æ€’æ—', 'ä¹Œå­œåˆ«å…‹æ—', 'ä¿„ç½—æ–¯æ—', 'é„‚æ¸©å…‹æ—', 'å¾·æ˜‚æ—', 'ä¿å®‰æ—', 'è£•å›ºæ—', 'äº¬æ—', 'å¡”å¡”å°”æ—', 'ç‹¬é¾™æ—', 'é„‚ä¼¦æ˜¥æ—', 'èµ«å“²æ—', 'é—¨å·´æ—', 'çå·´æ—', 'åŸºè¯ºæ—'],
            vocal_skill: ['ä¸“ä¸š', 'ä¼˜ç§€', 'è‰¯å¥½', 'ä¸€èˆ¬', 'å…¥é—¨'],
            live_effect_level: ['Sçº§', 'Açº§', 'Bçº§', 'Cçº§', 'Dçº§'],
            current_status: ['æ´»è·ƒ', 'ä¼‘æ¯', 'æš‚åœ', 'è§£çº¦'],
            contract_type: ['ç‹¬å®¶ç­¾çº¦', 'éç‹¬å®¶', 'å…¼èŒ'],
            music_style: ['æµè¡Œ', 'æ‘‡æ»š', 'æ°‘è°£', 'ç”µå­', 'å˜»å“ˆ', 'å¤å…¸', 'çˆµå£«', 'R&B', 'ä¹¡æ‘', 'å¤é£', 'é‡‘å±', 'è“è°ƒ', 'é›·é¬¼', 'æœ‹å…‹', 'æ‹‰ä¸'],
            relationship_status: ['å•èº«', 'æ‹çˆ±ä¸­', 'å·²å©š', 'ç¦»å¼‚', 'ä¸§å¶'],
            personality: ['å¼€æœ—', 'å†…å‘', 'æ´»æ³¼', 'æ²‰ç¨³', 'çƒ­æƒ…', 'å†·é™', 'å¹½é»˜', 'ä¸¥è‚ƒ', 'æ¸©æŸ”', 'å¼ºåŠ¿', 'ç»†è…»', 'è±ªçˆ½', 'æ•æ„Ÿ', 'å¤§å¤§å’§å’§', 'å®‰é™', 'å¤–å‘', 'ç‹¬ç«‹', 'ä¾èµ–'],
            mbti: ['ISTJ', 'ISFJ', 'INFJ', 'INTJ', 'ISTP', 'ISFP', 'INFP', 'INTP', 'ESTP', 'ESFP', 'ENFP', 'ENTP', 'ESTJ', 'ESFJ', 'ENFJ', 'ENTJ']
        };

        // åˆå§‹åŒ–å•ä¸ªä¸‹æ‹‰èœå•
        function initSingleDropdown(fieldId, fieldName) {
            const input = document.getElementById(fieldId);
            if (input && input.tagName === 'INPUT') {
                // åˆ›å»ºä¸‹æ‹‰èœå•
                const select = document.createElement('select');
                select.id = input.id;
                select.className = input.className;
                
                // æ·»åŠ ç©ºé€‰é¡¹
                const emptyOption = document.createElement('option');
                emptyOption.value = '';
                emptyOption.textContent = 'è¯·é€‰æ‹©';
                select.appendChild(emptyOption);
                
                // æ·»åŠ é€‰é¡¹
                dropdownOptions[fieldName].forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option;
                    opt.textContent = option;
                    select.appendChild(opt);
                });
                
                // ä¿ç•™åŸå§‹å€¼
                select.value = input.value;
                
                // æ›¿æ¢è¾“å…¥æ¡†ä¸ºä¸‹æ‹‰èœå•
                input.parentNode.replaceChild(select, input);
            }
        }

        // æ ¼å¼åŒ–æ—¥æœŸä¸º YYYYå¹´MMæœˆDDæ—¥ æ ¼å¼
        function formatDate(dateString) {
            if (!dateString) return '-';
            
            // åˆ›å»ºæ—¥æœŸå¯¹è±¡
            const date = new Date(dateString);
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
            if (isNaN(date.getTime())) return '-';
            
            // æå–å¹´æœˆæ—¥
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            
            // è¿”å›æ ¼å¼åŒ–åçš„æ—¥æœŸ
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }

        // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´ä¸º yyyyå¹´mmæœˆddæ—¥ HHç‚¹mmåˆ† æ ¼å¼
        function formatDateTime(dateString) {
            if (!dateString) return '-';

            const date = new Date(dateString);
            if (isNaN(date.getTime())) return '-';

            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');

            return `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}ç‚¹${minutes}åˆ†`;
        }

        // åˆå§‹åŒ–çœä»½ä¸‹æ‹‰æ¡†
        function initProvinceDropdowns() {
            const provinces = Object.keys(provincesCities);
            
            // åˆå§‹åŒ–ä½å€çœä»½ä¸‹æ‹‰æ¡†
            const addressProvinceSelect = document.getElementById('addressProvince');
            addressProvinceSelect.innerHTML = '<option value="">è¯·é€‰æ‹©çœä»½</option>';
            provinces.forEach(province => {
                const option = document.createElement('option');
                option.value = province;
                option.textContent = province;
                addressProvinceSelect.appendChild(option);
            });
            
            // åˆå§‹åŒ–æˆ·ç±åœ°çœä»½ä¸‹æ‹‰æ¡†
            const householdProvinceSelect = document.getElementById('householdProvince');
            householdProvinceSelect.innerHTML = '<option value="">è¯·é€‰æ‹©çœä»½</option>';
            provinces.forEach(province => {
                const option = document.createElement('option');
                option.value = province;
                option.textContent = province;
                householdProvinceSelect.appendChild(option);
            });
        }

        // æ›´æ–°åŸå¸‚ä¸‹æ‹‰æ¡†
        function updateCities(type) {
            const provinceSelect = document.getElementById(`${type}Province`);
            const citySelect = document.getElementById(`${type}City`);
            const selectedProvince = provinceSelect.value;
            
            citySelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
            
            if (selectedProvince && provincesCities[selectedProvince]) {
                const cities = provincesCities[selectedProvince];
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            }
        }
        
        // è§£æåœ°å€ä¸ºçœä»½å’ŒåŸå¸‚
        function parseAddress(address) {
            if (!address) return { province: '', city: '' };
            
            // éå†æ‰€æœ‰çœä»½ï¼ŒæŸ¥æ‰¾åŒ¹é…çš„çœä»½
            for (const province in provincesCities) {
                if (address.startsWith(province)) {
                    // çœä»½åŒ¹é…æˆåŠŸ
                    const remaining = address.substring(province.length);
                    // æŸ¥æ‰¾åŒ¹é…çš„åŸå¸‚
                    for (const city of provincesCities[province]) {
                        if (remaining.startsWith(city)) {
                            return { province, city };
                        }
                    }
                    // å¦‚æœæ²¡æœ‰åŒ¹é…çš„åŸå¸‚ï¼Œåªè¿”å›çœä»½
                    return { province, city: '' };
                }
            }
            
            return { province: '', city: '' };
        }
        
        // è®¾ç½®åœ°å€é€‰æ‹©å™¨çš„å€¼
        function setAddressValue(type, fullAddress) {
            const { province, city } = parseAddress(fullAddress);
            const provinceSelect = document.getElementById(`${type}Province`);
            const citySelect = document.getElementById(`${type}City`);
            
            // è®¾ç½®çœä»½
            provinceSelect.value = province;
            
            // æ›´æ–°åŸå¸‚ä¸‹æ‹‰æ¡†
            updateCities(type);
            
            // è®¾ç½®åŸå¸‚
            citySelect.value = city;
        }

        // åˆå§‹åŒ–æ‰€æœ‰ä¸‹æ‹‰èœå•
        function initDropdowns() {
            // å­—æ®µæ˜ å°„ï¼šå‰ç«¯ID -> åç«¯å­—æ®µå
            const fieldMap = {
                'ethnicity': 'ethnicity',
                'vocalSkill': 'vocal_skill',
                'liveEffectLevel': 'live_effect_level',
                'currentStatus': 'current_status',
                'contractType': 'contract_type',
                'musicStyle': 'music_style',
                'relationshipStatus': 'relationship_status',
                'personality': 'personality',
                'mbti': 'mbti'
            };
            
            // åˆå§‹åŒ–æ‰€æœ‰ä¸‹æ‹‰èœå•
            Object.entries(fieldMap).forEach(([fieldId, fieldName]) => {
                initSingleDropdown(fieldId, fieldName);
            });
            
            // åˆå§‹åŒ–çœä»½ä¸‹æ‹‰æ¡†
            initProvinceDropdowns();
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ä¸‹æ‹‰èœå•
        document.addEventListener('DOMContentLoaded', initDropdowns);
        
        // å½“æ¨¡æ€æ¡†æ‰“å¼€æ—¶ï¼Œç¡®ä¿ä¸‹æ‹‰èœå•å·²åˆå§‹åŒ–
        function ensureDropdownsInitialized() {
            // çŸ­æš‚å»¶è¿Ÿç¡®ä¿DOMå·²æ›´æ–°
            setTimeout(() => {
                initDropdowns();
            }, 100);
        }

        // ç­›é€‰åŠŸèƒ½
        function filterArtists() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const status = document.getElementById('statusFilter').value;
            const contractType = document.getElementById('contractTypeFilter').value;
            const gender = document.getElementById('genderFilter').value;
            const ethnicity = document.getElementById('ethnicityFilter').value;
            const vocalSkill = document.getElementById('vocalSkillFilter').value;
            const liveEffect = document.getElementById('liveEffectFilter').value;
            const weightMin = parseFloat(document.getElementById('weightMin').value) || 0;
            const weightMax = parseFloat(document.getElementById('weightMax').value) || Infinity;
            const heightMin = parseFloat(document.getElementById('heightMin').value) || 0;
            const heightMax = parseFloat(document.getElementById('heightMax').value) || Infinity;
            const revenueMin = parseFloat(document.getElementById('revenueMin').value) || 0;
            const revenueMax = parseFloat(document.getElementById('revenueMax').value) || Infinity;
            
            // èŒä¸šä¿¡æ¯ç­›é€‰
            const occupation = document.getElementById('occupationFilter').value;
            const musicStyle = document.getElementById('musicStyleFilter').value;
            
            // ä¸ªäººä¿¡æ¯ç­›é€‰
            const mbti = document.getElementById('mbtiFilter').value;
            const relationship = document.getElementById('relationshipFilter').value;
            const personality = document.getElementById('personalityFilter').value;
            const offlineWilling = document.getElementById('offlineWillingFilter').value;
            
            // æ‹›å‹Ÿä¿¡æ¯ç­›é€‰
            const recruiter = document.getElementById('recruiterFilter').value.toLowerCase();
            const recruitmentStatus = document.getElementById('recruitmentStatusFilter').value;

            const filteredArtists = artists.filter(artist => {
                // æœç´¢è¯ç­›é€‰
                const matchesSearch = !searchTerm ||
                    (artist.name && artist.name.toLowerCase().includes(searchTerm)) ||
                    (artist.douyin_account && artist.douyin_account.toLowerCase().includes(searchTerm));
                
                // çŠ¶æ€ç­›é€‰
                const matchesStatus = !status || artist.current_status === status;
                
                // ç­¾çº¦ç±»å‹ç­›é€‰
                const matchesContractType = !contractType || artist.contract_type === contractType;
                
                // æ€§åˆ«ç­›é€‰
                const matchesGender = !gender || artist.gender === gender;
                
                // æ°‘æ—ç­›é€‰
                const matchesEthnicity = !ethnicity || artist.ethnicity === ethnicity;
                
                // å”±åŠŸç­›é€‰
                const matchesVocalSkill = !vocalSkill || artist.vocal_skill === vocalSkill;
                
                // ç›´æ’­æ•ˆæœç­‰çº§ç­›é€‰
                const matchesLiveEffect = !liveEffect || artist.live_effect_level === liveEffect;
                
                // ä½“é‡èŒƒå›´ç­›é€‰
                const artistWeight = parseFloat(artist.weight) || 0;
                const matchesWeight = artistWeight >= weightMin && artistWeight <= weightMax;
                
                // èº«é«˜èŒƒå›´ç­›é€‰
                const artistHeight = parseFloat(artist.height) || 0;
                const matchesHeight = artistHeight >= heightMin && artistHeight <= heightMax;
                
                // æ€»æµæ°´èŒƒå›´ç­›é€‰
                const artistRevenue = parseFloat(artist.total_revenue) || 0;
                const matchesRevenue = artistRevenue >= revenueMin && artistRevenue <= revenueMax;
                
                // èŒä¸šç­›é€‰
                const matchesOccupation = !occupation || artist.occupation === occupation;
                
                // æ›²é£ç­›é€‰
                const matchesMusicStyle = !musicStyle || artist.music_style === musicStyle;
                
                // ä¸ªäººä¿¡æ¯ç­›é€‰
                const matchesMBTI = !mbti || artist.mbti === mbti;
                const matchesRelationship = !relationship || artist.relationship_status === relationship;
                const matchesPersonality = !personality || artist.personality === personality;
                const matchesOfflineWilling = !offlineWilling || artist.willing_offline === offlineWilling;
                
                // æ‹›å‹Ÿä¿¡æ¯ç­›é€‰
                const matchesRecruiter = !recruiter || (artist.recruiter && artist.recruiter.toLowerCase().includes(recruiter));
                const matchesRecruitmentStatus = !recruitmentStatus || artist.recruitment_status === recruitmentStatus;
                
                return matchesSearch && matchesStatus && matchesContractType && matchesGender && 
                       matchesEthnicity && matchesVocalSkill && matchesLiveEffect && 
                       matchesWeight && matchesHeight && matchesRevenue &&
                       matchesOccupation && matchesMusicStyle &&
                       matchesMBTI && matchesRelationship && matchesPersonality && matchesOfflineWilling &&
                       matchesRecruiter && matchesRecruitmentStatus;
            });
            
            renderArtists(filteredArtists);
        }

        // ä¸ºæ‰€æœ‰ç­›é€‰è¾“å…¥æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('searchInput').addEventListener('input', filterArtists);
        document.getElementById('statusFilter').addEventListener('change', filterArtists);
        document.getElementById('contractTypeFilter').addEventListener('change', filterArtists);
        document.getElementById('genderFilter').addEventListener('change', filterArtists);
        document.getElementById('ethnicityFilter').addEventListener('change', filterArtists);
        document.getElementById('vocalSkillFilter').addEventListener('change', filterArtists);
        document.getElementById('liveEffectFilter').addEventListener('change', filterArtists);
        document.getElementById('weightMin').addEventListener('input', filterArtists);
        document.getElementById('weightMax').addEventListener('input', filterArtists);
        document.getElementById('heightMin').addEventListener('input', filterArtists);
        document.getElementById('heightMax').addEventListener('input', filterArtists);
        document.getElementById('revenueMin').addEventListener('input', filterArtists);
        document.getElementById('revenueMax').addEventListener('input', filterArtists);
        
        // èŒä¸šä¿¡æ¯ç­›é€‰äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('occupationFilter').addEventListener('change', filterArtists);
        document.getElementById('musicStyleFilter').addEventListener('change', filterArtists);
        
        // ä¸ªäººä¿¡æ¯ç­›é€‰äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('mbtiFilter').addEventListener('change', filterArtists);
        document.getElementById('relationshipFilter').addEventListener('change', filterArtists);
        document.getElementById('personalityFilter').addEventListener('change', filterArtists);
        document.getElementById('offlineWillingFilter').addEventListener('change', filterArtists);

        // é‡ç½®ç­›é€‰
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('contractTypeFilter').value = '';
            document.getElementById('genderFilter').value = '';
            document.getElementById('ethnicityFilter').value = '';
            document.getElementById('vocalSkillFilter').value = '';
            document.getElementById('liveEffectFilter').value = '';
            document.getElementById('weightMin').value = '';
            document.getElementById('weightMax').value = '';
            document.getElementById('heightMin').value = '';
            document.getElementById('heightMax').value = '';
            document.getElementById('revenueMin').value = '';
            document.getElementById('revenueMax').value = '';
            
            // é‡ç½®èŒä¸šä¿¡æ¯ç­›é€‰
            document.getElementById('occupationFilter').value = '';
            document.getElementById('musicStyleFilter').value = '';
            
            // é‡ç½®ä¸ªäººä¿¡æ¯ç­›é€‰
            document.getElementById('mbtiFilter').value = '';
            document.getElementById('relationshipFilter').value = '';
            document.getElementById('personalityFilter').value = '';
            document.getElementById('offlineWillingFilter').value = '';
            
            // é‡ç½®æ‹›å‹Ÿä¿¡æ¯ç­›é€‰
            document.getElementById('recruiterFilter').value = '';
            document.getElementById('recruitmentStatusFilter').value = '';
            
            filterArtists();
        }

        // åŠ è½½æ“ä½œæ—¥å¿—
        async function loadOperationLogs(artistId) {
            const logsContainer = document.getElementById('operationLogs');
            if (!artistId) {
                logsContainer.innerHTML = '<div class="no-logs">æ— æ“ä½œæ—¥å¿—</div>';
                return;
            }

            try {
                const response = await fetch(`/api/artists/${artistId}/logs`);
                const result = await response.json();
                
                if (result.success && result.data) {
                    const logs = result.data;
                    
                    if (logs.length === 0) {
                        logsContainer.innerHTML = '<div class="no-logs">æ— æ“ä½œæ—¥å¿—</div>';
                        return;
                    }
                    
                    logsContainer.innerHTML = logs.map(log => `
                        <div class="log-item">
                            <div class="log-header">
                                <span class="log-operator">${log.operator}</span>
                                <span class="log-time">${log.operation_time}</span>
                            </div>
                            <span class="log-type ${log.operation_type}">${log.operation_type}</span>
                            <div class="log-content">${log.operation_content}</div>
                        </div>
                    `).join('');
                } else {
                    logsContainer.innerHTML = '<div class="no-logs">åŠ è½½æ—¥å¿—å¤±è´¥</div>';
                }
            } catch (error) {
                console.error('åŠ è½½æ“ä½œæ—¥å¿—å¤±è´¥:', error);
                logsContainer.innerHTML = '<div class="no-logs">åŠ è½½æ—¥å¿—å¤±è´¥</div>';
            }
        }

        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal(artist = null) {
            const modal = document.getElementById('artistModal');
            const title = document.getElementById('modalTitle');
            const form = document.getElementById('artistForm');
            const mediaPreview = document.getElementById('mediaPreview');

            // æ¸…ç©ºåª’ä½“é¢„è§ˆ
            mediaPreview.innerHTML = '';
            
            // é‡ç½®æ–‡ä»¶è¾“å…¥æ¡†
            document.getElementById('singerAttachment').value = '';

            if (artist) {
                title.textContent = 'ç¼–è¾‘è‰ºäºº';
                document.getElementById('artistId').value = artist.id;
                document.getElementById('name').value = artist.name || '';
                document.getElementById('realName').value = artist.real_name || '';
                document.getElementById('douyinAccount').value = artist.douyin_account || '';
                document.getElementById('phone').value = artist.phone || '';
                document.getElementById('wechat').value = artist.wechat || '';
                document.getElementById('recruiter').value = artist.recruiter || '';
                document.getElementById('recruitmentStatus').value = artist.recruitment_status || '';
                document.getElementById('gender').value = artist.gender || '';
                document.getElementById('ethnicity').value = artist.ethnicity || '';
                document.getElementById('artMajor').value = artist.art_major || '';
                document.getElementById('vocalSkill').value = artist.vocal_skill || '';
                document.getElementById('liveEffectLevel').value = artist.live_effect_level || '';
                document.getElementById('totalRevenue').value = artist.total_revenue || '';
                document.getElementById('currentStatus').value = artist.current_status || '';
                setAddressValue('address', artist.address || '');
                setAddressValue('household', artist.household_address || '');
                document.getElementById('willingOffline').value = artist.willing_offline || '';
                document.getElementById('exposureParts').value = artist.exposure_parts || '';
                document.getElementById('contractType').value = artist.contract_type || '';
                document.getElementById('remarks').value = artist.remarks || '';
                document.getElementById('joinDate').value = artist.join_date || '';
                document.getElementById('height').value = artist.height || '';
                document.getElementById('weight').value = artist.weight || '';
                document.getElementById('birthDate').value = artist.birth_date || '';
                document.getElementById('relationshipStatus').value = artist.relationship_status || '';
                document.getElementById('personality').value = artist.personality || '';
                document.getElementById('mbti').value = artist.mbti || '';
                document.getElementById('occupation').value = artist.occupation || '';
                document.getElementById('skills').value = artist.skills || '';
                document.getElementById('fanName').value = artist.fan_name || '';
                document.getElementById('musicStyle').value = artist.music_style || '';
                document.getElementById('expectation').value = artist.expectation || '';
                document.getElementById('bond').value = artist.bond || '';
                
                // æ˜¾ç¤ºå·²ä¸Šä¼ çš„åª’ä½“æ–‡ä»¶
                if (artist.singer_attachment) {
                    const files = artist.singer_attachment.split(',');
                    files.forEach(filename => {
                        const fileUrl = `/uploads/${filename}`;
                        const mediaElement = document.createElement(filename.endsWith('.mp4') || filename.endsWith('.mov') || filename.endsWith('.avi') ? 'video' : 'img');
                        
                        if (mediaElement.tagName === 'VIDEO') {
                            mediaElement.controls = true;
                            mediaElement.style.maxWidth = '100%';
                            mediaElement.style.maxHeight = '200px';
                            mediaElement.style.marginRight = '10px';
                            mediaElement.style.marginBottom = '10px';
                            mediaElement.src = fileUrl;
                        } else {
                            mediaElement.style.maxWidth = '200px';
                            mediaElement.style.maxHeight = '200px';
                            mediaElement.style.marginRight = '10px';
                            mediaElement.style.marginBottom = '10px';
                            mediaElement.style.cursor = 'pointer';
                            mediaElement.src = fileUrl;
                            mediaElement.onclick = () => {
                                openMediaPreview(fileUrl, mediaElement.tagName === 'VIDEO');
                            };
                        }
                        
                        mediaPreview.appendChild(mediaElement);
                    });
                }
            } else {
                title.textContent = 'æ–°å¢è‰ºäºº';
                form.reset();
                document.getElementById('artistId').value = '';
                // è‡ªåŠ¨å¡«å……æ‹›å‹Ÿäººä¸ºå½“å‰ç”¨æˆ·
                document.getElementById('recruiter').value = currentOperator || 'æœªçŸ¥ç”¨æˆ·';
            }

            modal.classList.add('active');
            
            // ç¡®ä¿ä¸‹æ‹‰èœå•å·²åˆå§‹åŒ–
            ensureDropdownsInitialized();
            
            // åŠ è½½æ“ä½œæ—¥å¿—
            loadOperationLogs(artist ? artist.id : null);
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            document.getElementById('artistModal').classList.remove('active');
        }

        // æ‰§è¡Œæ“ä½œï¼ˆè‡ªåŠ¨ä½¿ç”¨å½“å‰ç™»å½•ç”¨æˆ·ä½œä¸ºæ“ä½œäººï¼‰
        async function executeOperation(operation, data) {
            if (!currentOperator) {
                alert('è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                return;
            }

            try {
                let result;
                
                // æ ¹æ®å½“å‰æ“ä½œç±»å‹æ‰§è¡Œç›¸åº”æ“ä½œ
                switch (operation) {
                    case 'create':
                        result = await createArtistWithOperator(currentOperator, data);
                        break;
                    case 'update':
                        result = await updateArtistWithOperator(currentOperator, data);
                        break;
                    case 'delete':
                        result = await deleteArtistWithOperator(currentOperator, data.id);
                        break;
                }

                if (result.success) {
                    await loadArtists();
                    closeModal();
                    alert(operation === 'create' ? 'åˆ›å»ºæˆåŠŸ' : operation === 'update' ? 'æ›´æ–°æˆåŠŸ' : 'åˆ é™¤æˆåŠŸ');
                } else {
                    alert(result.error || 'æ“ä½œå¤±è´¥');
                }
            } catch (error) {
                console.error('æ“ä½œå¤±è´¥:', error);
                alert('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // æ‰“å¼€æ“ä½œäººç¡®è®¤æ¨¡æ€æ¡†ï¼ˆä»…ç”¨äºå…¼å®¹æ—§ä»£ç ï¼Œå®é™…ä¸å†éœ€è¦æ‰‹åŠ¨è¾“å…¥ï¼‰
        function openOperatorModal(operation, data) {
            // ç›´æ¥æ‰§è¡Œæ“ä½œï¼Œä¸æ˜¾ç¤ºæ¨¡æ€æ¡†
            executeOperation(operation, data);
        }

        // å…³é—­æ“ä½œäººç¡®è®¤æ¨¡æ€æ¡†ï¼ˆä»…ç”¨äºå…¼å®¹æ—§ä»£ç ï¼‰
        function closeOperatorModal() {
            // ä¸éœ€è¦å®é™…å…³é—­ï¼Œå› ä¸ºä¸å†æ˜¾ç¤ºæ¨¡æ€æ¡†
        }

        // ç¡®è®¤æ“ä½œäººï¼ˆä»…ç”¨äºå…¼å®¹æ—§ä»£ç ï¼‰
        async function confirmOperator() {
            // æ­¤å‡½æ•°ä¸å†ä½¿ç”¨
        }

        // å¸¦æ“ä½œäººçš„åˆ›å»ºè‰ºäººå‡½æ•°
        async function createArtistWithOperator(operator, data) {
            data.operator = operator;
            const response = await fetch('/api/artists', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            return await response.json();
        }

        // å¸¦æ“ä½œäººçš„æ›´æ–°è‰ºäººå‡½æ•°
        async function updateArtistWithOperator(operator, data) {
            data.operator = operator;
            const response = await fetch(`/api/artists/${data.id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            return await response.json();
        }

        // å¸¦æ“ä½œäººçš„åˆ é™¤è‰ºäººå‡½æ•°
        async function deleteArtistWithOperator(operator, artistId) {
            const response = await fetch(`/api/artists/${artistId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ operator })
            });
            return await response.json();
        }
        
        // æ‰“å¼€åª’ä½“é¢„è§ˆæ¨¡æ€æ¡†
        function openMediaPreview(fileUrl, isVideo) {
            const modal = document.getElementById('mediaPreviewModal');
            const content = document.getElementById('mediaPreviewContent');
            
            // æ¸…ç©ºå†…å®¹
            content.innerHTML = '';
            
            // åˆ›å»ºåª’ä½“å…ƒç´ 
            const mediaElement = document.createElement(isVideo ? 'video' : 'img');
            
            if (isVideo) {
                mediaElement.controls = true;
                mediaElement.style.maxWidth = '90vw';
                mediaElement.style.maxHeight = '90vh';
                mediaElement.style.objectFit = 'contain';
                mediaElement.src = fileUrl;
            } else {
                mediaElement.style.maxWidth = '90vw';
                mediaElement.style.maxHeight = '90vh';
                mediaElement.style.objectFit = 'contain';
                mediaElement.src = fileUrl;
            }
            
            content.appendChild(mediaElement);
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.style.display = 'flex';
        }
        
        // å…³é—­åª’ä½“é¢„è§ˆæ¨¡æ€æ¡†
        function closeMediaPreview() {
            const modal = document.getElementById('mediaPreviewModal');
            modal.style.display = 'none';
        }
        
        // ç‚¹å‡»åª’ä½“é¢„è§ˆæ¨¡æ€æ¡†ç©ºç™½å¤„å…³é—­
        document.getElementById('mediaPreviewModal').addEventListener('click', function(e) {
            const modal = document.getElementById('mediaPreviewModal');
            const content = document.getElementById('mediaPreviewContent');
            
            // å¦‚æœç‚¹å‡»çš„æ˜¯æ¨¡æ€æ¡†èƒŒæ™¯ï¼Œè€Œä¸æ˜¯å†…å®¹åŒºåŸŸï¼Œå…³é—­æ¨¡æ€æ¡†
            if (e.target === modal || e.target === content) {
                closeMediaPreview();
            }
        });

        // ç¼–è¾‘è‰ºäºº
        async function editArtist(id) {
            console.log('editArtist called with id:', id);

            try {
                const response = await fetch(`/api/artists/${id}`);
                const result = await response.json();
                if (result.success) {
                    openModal(result.data);
                } else {
                    alert('è·å–è‰ºäººä¿¡æ¯å¤±è´¥');
                }
            } catch (error) {
                console.error('è·å–è‰ºäººä¿¡æ¯å¤±è´¥:', error);
                alert('è·å–è‰ºäººä¿¡æ¯å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // åˆ é™¤è‰ºäºº
        async function deleteArtist(id) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè‰ºäººå—ï¼Ÿ')) return;

            // æ‰“å¼€æ“ä½œäººç¡®è®¤æ¨¡æ€æ¡†
            openOperatorModal('delete', id);
        }

        // æŸ¥çœ‹è‰ºäººè¯¦æƒ…
        async function viewArtistDetail(id) {
            const modal = document.getElementById('artistDetailModal');
            modal.classList.add('active');

            // è·å–è‰ºäººä¿¡æ¯
            const response = await fetch(`/api/artists/${id}`);
            const result = await response.json();

            if (result.success) {
                const artist = result.data;
                currentArtistId = id;

                // åŸºæœ¬ä¿¡æ¯
                document.getElementById('detailBasicInfo').innerHTML = `
                    <div class="info-item"><label>è‰ºå</label> - <span>${artist.name || '-'}</span></div>
                    <div class="info-item"><label>çœŸå</label> - <span>${artist.real_name || '-'}</span></div>
                    <div class="info-item"><label>æŠ–éŸ³å·</label> - <span>${artist.douyin_account || '-'}</span></div>
                    <div class="info-item"><label>æ€§åˆ«</label> - <span>${artist.gender || '-'}</span></div>
                    <div class="info-item"><label>æ°‘æ—</label> - <span>${artist.ethnicity || '-'}</span></div>
                    <div class="info-item"><label>èŒä¸š</label> - <span>${artist.occupation || '-'}</span></div>
                    <div class="info-item"><label>å½“å‰çŠ¶æ€</label> - <span class="tag">${artist.current_status || '-'}</span></div>
                    <div class="info-item"><label>ç­¾çº¦ç±»å‹</label> - <span>${artist.contract_type || '-'}</span></div>
                    <div class="info-item"><label>åŠ å…¥æ—¥æœŸ</label> - <span>${formatDate(artist.join_date)}</span></div>
                    <div class="info-item"><label>å‡ºç”Ÿæ—¥æœŸ</label> - <span>${formatDate(artist.birth_date)}</span></div>
                `;

                // è”ç³»æ–¹å¼
                document.getElementById('detailContactInfo').innerHTML = `
                    <div class="info-item"><label>æ‰‹æœºå·ç </label> - <span>${artist.phone || '-'}</span></div>
                    <div class="info-item"><label>å¾®ä¿¡å·</label> - <span>${artist.wechat || '-'}</span></div>
                    <div class="info-item"><label>ç°å±…ä½åœ°</label> - <span>${artist.address || '-'}</span></div>
                    <div class="info-item"><label>æˆ·ç±åœ°å€</label> - <span>${artist.household_address || '-'}</span></div>
                `;

                // æ‹›å‹Ÿä¿¡æ¯
                document.getElementById('detailRecruitmentInfo').innerHTML = `
                    <div class="info-item"><label>æ‹›å‹Ÿäºº</label> - <span>${artist.recruiter || '-'}</span></div>
                    <div class="info-item"><label>æ‹›å‹ŸçŠ¶æ€</label> - <span class="tag">${artist.recruitment_status || '-'}</span></div>
                    <div class="info-item"><label>å”±åŠŸ</label> - <span>${artist.vocal_skill || '-'}</span></div>
                    <div class="info-item"><label>ç›´æ’­æ•ˆæœ</label> - <span>${artist.live_effect_level || '-'}</span></div>
                `;

                // è‡ªåŠ¨å¡«å……æ“ä½œäºº
                document.getElementById('followUpOperator').value = currentOperator || 'æœªçŸ¥ç”¨æˆ·';

                // åŠ è½½è·Ÿè¿›è®°å½•
                loadFollowUps(id);
            }
        }

        // åŠ è½½è·Ÿè¿›è®°å½•ï¼ˆä»…æ˜¾ç¤ºæœ€æ–°5æ¡ï¼‰
        async function loadFollowUps(artistId) {
            const response = await fetch(`/api/artists/${artistId}/follow-ups`);
            const result = await response.json();

            const timeline = document.getElementById('followUpTimeline');

            if (result.success && result.data.length > 0) {
                // åªå–æœ€æ–°5æ¡
                const top5 = result.data.slice(0, 5);
                timeline.innerHTML = top5.map(followUp => `
                    <div class="timeline-item" data-id="${followUp.id}">
                        <div class="timeline-content">
                            <div class="timeline-operator">${followUp.operator || 'æœªçŸ¥'}</div>
                            <div class="timeline-text">${followUp.content}</div>
                            <div class="timeline-time">${formatDateTime(followUp.created_at)}</div>
                        </div>
                    </div>
                `).join('');
            } else {
                timeline.innerHTML = '<div class="no-logs">æš‚æ— è·Ÿè¿›è®°å½•</div>';
            }
        }

        // æ·»åŠ è·Ÿè¿›è®°å½•
        async function addFollowUp() {
            if (!currentArtistId) return;

            const operator = document.getElementById('followUpOperator').value.trim();
            const content = document.getElementById('newFollowUpContent').value.trim();
            
            if (!operator) {
                alert('è¯·è¾“å…¥æ“ä½œäºº');
                return;
            }
            if (!content) {
                alert('è¯·è¾“å…¥è·Ÿè¿›è®°å½•å†…å®¹');
                return;
            }

            const response = await fetch(`/api/artists/${currentArtistId}/follow-ups`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    content: content,
                    operator: operator
                })
            });

            const result = await response.json();

            if (result.success) {
                document.getElementById('newFollowUpContent').value = '';
                document.getElementById('followUpOperator').value = '';
                loadFollowUps(currentArtistId);
            } else {
                alert('æ·»åŠ è·Ÿè¿›è®°å½•å¤±è´¥');
            }
        }

        // å…³é—­è‰ºäººè¯¦æƒ…æ¨¡æ€æ¡†
        function closeArtistDetailModal() {
            const modal = document.getElementById('artistDetailModal');
            modal.classList.remove('active');
            currentArtistId = null;
        }

        // æ‰“å¼€æ‰¹é‡ä¸Šä¼ æ¨¡æ€æ¡†
        function openBulkUploadModal() {
            const modal = document.getElementById('bulkUploadModal');
            modal.style.display = 'flex';
        }

        // å…³é—­æ‰¹é‡ä¸Šä¼ æ¨¡æ€æ¡†
        function closeBulkUploadModal() {
            const modal = document.getElementById('bulkUploadModal');
            modal.style.display = 'none';
        }

        // æäº¤æ‰¹é‡ä¸Šä¼ 
        async function submitBulkUpload() {
            const fileInput = document.getElementById('bulkFile');
            const operatorInput = document.getElementById('bulkOperator');
            
            if (!fileInput.files[0]) {
                alert('è¯·é€‰æ‹©CSVæ–‡ä»¶');
                return;
            }
            
            if (!operatorInput.value.trim()) {
                alert('è¯·è¾“å…¥æ“ä½œäººå§“å');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);
            formData.append('operator', operatorInput.value.trim());
            
            try {
                const response = await fetch('/api/artists/bulk', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                if (result.success) {
                    alert(`æ‰¹é‡ä¸Šä¼ æˆåŠŸï¼Œå…±å¤„ç† ${result.success_count} æ¡è®°å½•ï¼Œå¤±è´¥ ${result.error_count} æ¡`);
                    closeBulkUploadModal();
                    loadArtists();
                } else {
                    alert(`æ‰¹é‡ä¸Šä¼ å¤±è´¥: ${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (error) {
                console.error('æ‰¹é‡ä¸Šä¼ å¤±è´¥:', error);
                alert('æ‰¹é‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // è¡¨å•æäº¤
        document.getElementById('artistForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const artistId = document.getElementById('artistId').value;
            const formData = new FormData();
            
            // è·å–æ–‡ä»¶ä¸Šä¼ æ§ä»¶
            const fileInput = document.getElementById('singerAttachment');
            
            // ä¸Šä¼ æ–‡ä»¶
            let uploadedFiles = [];
            if (fileInput.files.length > 0) {
                const uploadFormData = new FormData();
                for (let i = 0; i < fileInput.files.length; i++) {
                    uploadFormData.append('file', fileInput.files[i]);
                }
                
                const uploadResponse = await fetch('/api/upload', {
                    method: 'POST',
                    body: uploadFormData
                });
                
                const uploadResult = await uploadResponse.json();
                if (uploadResult.success) {
                    uploadedFiles = uploadResult.files;
                } else {
                    alert('æ–‡ä»¶ä¸Šä¼ å¤±è´¥: ' + (uploadResult.error || 'æœªçŸ¥é”™è¯¯'));
                    return;
                }
            }
            
            // æ„å»ºè‰ºäººæ•°æ®
            const addressProvince = document.getElementById('addressProvince').value;
            const addressCity = document.getElementById('addressCity').value;
            const householdProvince = document.getElementById('householdProvince').value;
            const householdCity = document.getElementById('householdCity').value;
            
            const data = {
                name: document.getElementById('name').value,
                real_name: document.getElementById('realName').value,
                douyin_account: document.getElementById('douyinAccount').value,
                phone: document.getElementById('phone').value,
                wechat: document.getElementById('wechat').value,
                recruiter: document.getElementById('recruiter').value,
                recruitment_status: document.getElementById('recruitmentStatus').value,
                gender: document.getElementById('gender').value,
                ethnicity: document.getElementById('ethnicity').value,
                art_major: document.getElementById('artMajor').value,
                vocal_skill: document.getElementById('vocalSkill').value,
                live_effect_level: document.getElementById('liveEffectLevel').value,
                total_revenue: document.getElementById('totalRevenue').value || 0,
                current_status: document.getElementById('currentStatus').value,
                singer_attachment: uploadedFiles.join(','),
                address: `${addressProvince}${addressCity}`,
                household_address: `${householdProvince}${householdCity}`,
                willing_offline: document.getElementById('willingOffline').value,
                exposure_parts: document.getElementById('exposureParts').value,
                contract_type: document.getElementById('contractType').value,
                remarks: document.getElementById('remarks').value,
                join_date: document.getElementById('joinDate').value || null,
                height: document.getElementById('height').value || null,
                weight: document.getElementById('weight').value || null,
                birth_date: document.getElementById('birthDate').value || null,
                relationship_status: document.getElementById('relationshipStatus').value,
                personality: document.getElementById('personality').value,
                mbti: document.getElementById('mbti').value,
                occupation: document.getElementById('occupation').value,
                skills: document.getElementById('skills').value,
                fan_name: document.getElementById('fanName').value,
                music_style: document.getElementById('musicStyle').value,
                expectation: document.getElementById('expectation').value,
                bond: document.getElementById('bond').value
            };

            // æ‰“å¼€æ“ä½œäººç¡®è®¤æ¨¡æ€æ¡†
            const dataWithId = {...data, id: artistId};
            openOperatorModal(artistId ? 'update' : 'create', dataWithId);
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­åŠŸèƒ½å·²ç¦ç”¨
        // document.getElementById('artistModal').addEventListener('click', function(e) {
        //     if (e.target === this) {
        //         closeModal();
        //     }
        // });

        // æ·»åŠ äº‹ä»¶å§”æ‰˜ï¼Œå¤„ç†è‰ºåç‚¹å‡»äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM åŠ è½½å®Œæˆï¼Œæ·»åŠ äº‹ä»¶å§”æ‰˜');
            const artistsList = document.getElementById('artistsList');
            
            // ç¡®ä¿å…ƒç´ å­˜åœ¨
            if (artistsList) {
                console.log('æ‰¾åˆ°äº† artistsList å…ƒç´ ');
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
                artistsList.addEventListener('click', function(e) {
                    console.log('ç‚¹å‡»äº‹ä»¶è¢«è§¦å‘ï¼Œç›®æ ‡å…ƒç´ :', e.target);
                    const target = e.target;
                    
                    // æ£€æŸ¥ç‚¹å‡»çš„å…ƒç´ æ˜¯å¦æ˜¯è‰ºåå•å…ƒæ ¼æˆ–å…¶åä»£
                    const artistNameElement = target.closest('.artist-name');
                    console.log('artistNameElement:', artistNameElement);
                    
                    if (artistNameElement) {
                        // è·å–å¯¹åº”çš„è‰ºäººID
                        const tr = target.closest('tr');
                        console.log('å¯¹åº”çš„ tr å…ƒç´ :', tr);
                        
                        const artistId = parseInt(tr.dataset.id);
                        console.log('è·å–åˆ°çš„è‰ºäººID:', artistId);
                        
                        // è°ƒç”¨ç¼–è¾‘å‡½æ•°
                        console.log('è°ƒç”¨ editArtist å‡½æ•°');
                        editArtist(artistId);
                    }
                });
            } else {
                console.error('æœªæ‰¾åˆ° artistsList å…ƒç´ ');
            }
        });
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        function initPage() {
            // åŠ è½½è‰ºäººåˆ—è¡¨
            loadArtists();
            // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
            getCurrentUser();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initPage);
        } else {
            // DOMå·²ç»åŠ è½½å®Œæˆï¼Œç›´æ¥åˆå§‹åŒ–
            initPage();
        }

        // ========== ç®¡ç†è‰ºäººé¡¹ç›®åŠŸèƒ½ ==========
        // ç®¡ç†è‰ºäººé¡¹ç›®
        function manageArtistProjects(artistId) {
            const modal = document.getElementById('manageProjectsModal');
            document.getElementById('currentArtistId').value = artistId;
            document.getElementById('manageProjectsTitle').textContent = `ç®¡ç†è‰ºäººé¡¹ç›®`;
            
            // æ˜¾ç¤ºå·²å‚ä¸é¡¹ç›®
            showArtistProjects(artistId);
            
            modal.classList.add('active');
        }

        // å…³é—­ç®¡ç†é¡¹ç›®æ¨¡æ€æ¡†
        function closeManageProjectsModal() {
            const modal = document.getElementById('manageProjectsModal');
            modal.classList.remove('active');
        }

        // æ˜¾ç¤ºè‰ºäººå·²å‚ä¸çš„é¡¹ç›®
        async function showArtistProjects(artistId) {
            try {
                const response = await fetch(`/api/artists/${artistId}`);
                const result = await response.json();
                
                if (result.success) {
                    const artist = result.data;
                    const projectsList = document.getElementById('artistProjectsList');
                    
                    if (artist.projects && artist.projects.length > 0) {
                        projectsList.innerHTML = artist.projects.map(project => `
                            <div style="display: flex; justify-content: space-between; align-items: center; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <div>
                                    <strong>${project.title}</strong>
                                    <span style="margin-left: 10px; color: #667eea;">${project.type || '-'}</span>
                                    ${project.release_date ? `<span style="margin-left: 10px; color: #666; font-size: 0.9rem;">${project.release_date}</span>` : ''}
                                </div>
                                <button class="btn btn-delete btn-small" onclick="removeArtistFromProject(${project.id}, ${artistId})")>ç§»é™¤</button>
                            </div>
                        `).join('');
                    } else {
                        projectsList.innerHTML = '<p style="color: #95a5a6; font-style: italic;">æš‚æ— å‚ä¸é¡¹ç›®</p>';
                    }
                }
            } catch (error) {
                console.error('åŠ è½½è‰ºäººé¡¹ç›®å¤±è´¥:', error);
            }
        }

        // æœç´¢é¡¹ç›®
        async function searchProjects() {
            const searchTerm = document.getElementById('projectSearch').value;
            const resultsDiv = document.getElementById('projectSearchResults');
            
            if (!searchTerm.trim()) {
                resultsDiv.innerHTML = '<p style="color: #95a5a6; font-style: italic;">è¯·è¾“å…¥æœç´¢å…³é”®è¯</p>';
                return;
            }
            
            try {
                const response = await fetch(`/api/projects`);
                const result = await response.json();
                
                if (result.success) {
                    const projects = result.data;
                    const filteredProjects = projects.filter(project => 
                        project.title.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                    
                    if (filteredProjects.length > 0) {
                        resultsDiv.innerHTML = filteredProjects.map(project => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px; margin-bottom: 5px; border: 2px solid #e1e8ed;">
                                <div>
                                    <strong>${project.title}</strong>
                                    <span style="margin-left: 10px; color: #667eea;">${project.type || '-'}</span>
                                    ${project.release_date ? `<span style="margin-left: 10px; color: #666; font-size: 0.9rem;">${project.release_date}</span>` : ''}
                                </div>
                                <button class="btn btn-primary btn-small" onclick="addArtistToProject(${document.getElementById('currentArtistId').value}, ${project.id}, '${project.title}')">æ·»åŠ </button>
                            </div>
                        `).join('');
                    } else {
                        resultsDiv.innerHTML = '<p style="color: #95a5a6; font-style: italic;">æœªæ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®</p>';
                    }
                }
            } catch (error) {
                console.error('æœç´¢é¡¹ç›®å¤±è´¥:', error);
                resultsDiv.innerHTML = '<p style="color: #ff4757; font-style: italic;">æœç´¢å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }

        // æ·»åŠ è‰ºäººåˆ°é¡¹ç›®
        async function addArtistToProject(artistId, projectId, projectName) {
            try {
                const response = await fetch('/api/artist-projects', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        artist_id: artistId,
                        project_id: projectId,
                        role: '',
                        role_type: ''
                    })
                });
                
                if (response.ok) {
                    // é‡æ–°æ˜¾ç¤ºå·²å‚ä¸é¡¹ç›®
                    showArtistProjects(artistId);
                    // æ¸…ç©ºæœç´¢ç»“æœ
                    document.getElementById('projectSearchResults').innerHTML = '';
                    document.getElementById('projectSearch').value = '';
                } else {
                    const result = await response.json();
                    alert('æ·»åŠ å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('æ·»åŠ é¡¹ç›®å¤±è´¥:', error);
                alert('æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // ä»é¡¹ç›®ä¸­ç§»é™¤è‰ºäºº
        async function removeArtistFromProject(projectId, artistId) {
            if (!confirm('ç¡®å®šè¦ç§»é™¤è¯¥é¡¹ç›®å—ï¼Ÿ')) {
                return;
            }
            
            try {
                // è·å–å…³è”ID
                const artistResponse = await fetch(`/api/artists/${artistId}`);
                const artistResult = await artistResponse.json();
                
                if (artistResult.success) {
                    const artistProject = artistResult.data.projects.find(p => p.id === projectId);
                    if (artistProject && artistProject.id) {
                        const response = await fetch(`/api/artist-projects/${artistProject.id}`, {
                            method: 'DELETE'
                        });
                        
                        if (response.ok) {
                            // é‡æ–°æ˜¾ç¤ºå·²å‚ä¸é¡¹ç›®
                            showArtistProjects(artistId);
                        } else {
                            const result = await response.json();
                            alert('ç§»é™¤å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'));
                        }
                    }
                }
            } catch (error) {
                console.error('ç§»é™¤é¡¹ç›®å¤±è´¥:', error);
                alert('ç§»é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // ========== ç®¡ç†è‰ºäººæ´»åŠ¨åŠŸèƒ½ ==========
        // ç®¡ç†è‰ºäººæ´»åŠ¨
        function manageArtistActivities(artistId) {
            const modal = document.getElementById('manageActivitiesModal');
            document.getElementById('currentArtistIdForActivities').value = artistId;
            document.getElementById('manageActivitiesTitle').textContent = `ç®¡ç†è‰ºäººæ´»åŠ¨`;
            
            // æ˜¾ç¤ºå·²å‚ä¸æ´»åŠ¨
            showArtistActivities(artistId);
            
            modal.classList.add('active');
        }

        // å…³é—­ç®¡ç†æ´»åŠ¨æ¨¡æ€æ¡†
        function closeManageActivitiesModal() {
            const modal = document.getElementById('manageActivitiesModal');
            modal.classList.remove('active');
        }

        // æ˜¾ç¤ºè‰ºäººå·²å‚ä¸çš„æ´»åŠ¨
        async function showArtistActivities(artistId) {
            try {
                const response = await fetch(`/api/artists/${artistId}`);
                const result = await response.json();
                
                if (result.success) {
                    const artist = result.data;
                    const activitiesList = document.getElementById('artistActivitiesList');
                    
                    if (artist.activities && artist.activities.length > 0) {
                        activitiesList.innerHTML = artist.activities.map(activity => `
                            <div style="display: flex; justify-content: space-between; align-items: center; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <div>
                                    <strong>${activity.title}</strong>
                                    <span style="margin-left: 10px; color: #fa709a;">${activity.type || '-'}</span>
                                    ${activity.activity_date ? `<span style="margin-left: 10px; color: #666; font-size: 0.9rem;">${activity.activity_date}</span>` : ''}
                                </div>
                                <button class="btn btn-delete btn-small" onclick="removeArtistFromActivity(${activity.id}, ${artistId})")>ç§»é™¤</button>
                            </div>
                        `).join('');
                    } else {
                        activitiesList.innerHTML = '<p style="color: #95a5a6; font-style: italic;">æš‚æ— å‚ä¸æ´»åŠ¨</p>';
                    }
                }
            } catch (error) {
                console.error('åŠ è½½è‰ºäººæ´»åŠ¨å¤±è´¥:', error);
            }
        }

        // æœç´¢æ´»åŠ¨
        async function searchActivities() {
            const searchTerm = document.getElementById('activitySearch').value;
            const resultsDiv = document.getElementById('activitySearchResults');
            
            if (!searchTerm.trim()) {
                resultsDiv.innerHTML = '<p style="color: #95a5a6; font-style: italic;">è¯·è¾“å…¥æœç´¢å…³é”®è¯</p>';
                return;
            }
            
            try {
                const response = await fetch(`/api/activities`);
                const result = await response.json();
                
                if (result.success) {
                    const activities = result.data;
                    const filteredActivities = activities.filter(activity => 
                        activity.title.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                    
                    if (filteredActivities.length > 0) {
                        resultsDiv.innerHTML = filteredActivities.map(activity => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px; margin-bottom: 5px; border: 2px solid #e1e8ed;">
                                <div>
                                    <strong>${activity.title}</strong>
                                    <span style="margin-left: 10px; color: #fa709a;">${activity.type || '-'}</span>
                                    ${activity.activity_date ? `<span style="margin-left: 10px; color: #666; font-size: 0.9rem;">${activity.activity_date}</span>` : ''}
                                </div>
                                <button class="btn btn-primary btn-small" onclick="addArtistToActivity(${document.getElementById('currentArtistIdForActivities').value}, ${activity.id}, '${activity.title}')">æ·»åŠ </button>
                            </div>
                        `).join('');
                    } else {
                        resultsDiv.innerHTML = '<p style="color: #95a5a6; font-style: italic;">æœªæ‰¾åˆ°åŒ¹é…çš„æ´»åŠ¨</p>';
                    }
                }
            } catch (error) {
                console.error('æœç´¢æ´»åŠ¨å¤±è´¥:', error);
                resultsDiv.innerHTML = '<p style="color: #ff4757; font-style: italic;">æœç´¢å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }

        // æ·»åŠ è‰ºäººåˆ°æ´»åŠ¨
        async function addArtistToActivity(artistId, activityId, activityName) {
            try {
                const response = await fetch('/api/artist-activities', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        artist_id: artistId,
                        activity_id: activityId,
                        role: '',
                        performance_notes: ''
                    })
                });
                
                if (response.ok) {
                    // é‡æ–°æ˜¾ç¤ºå·²å‚ä¸æ´»åŠ¨
                    showArtistActivities(artistId);
                    // æ¸…ç©ºæœç´¢ç»“æœ
                    document.getElementById('activitySearchResults').innerHTML = '';
                    document.getElementById('activitySearch').value = '';
                } else {
                    const result = await response.json();
                    alert('æ·»åŠ å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('æ·»åŠ æ´»åŠ¨å¤±è´¥:', error);
                alert('æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // ä»æ´»åŠ¨ä¸­ç§»é™¤è‰ºäºº
        async function removeArtistFromActivity(activityId, artistId) {
            if (!confirm('ç¡®å®šè¦ç§»é™¤è¯¥æ´»åŠ¨å—ï¼Ÿ')) {
                return;
            }
            
            try {
                // è·å–å…³è”ID
                const artistResponse = await fetch(`/api/artists/${artistId}`);
                const artistResult = await artistResponse.json();
                
                if (artistResult.success) {
                    const artistActivity = artistResult.data.activities.find(a => a.id === activityId);
                    if (artistActivity && artistActivity.id) {
                        const response = await fetch(`/api/artist-activities/${artistActivity.id}`, {
                            method: 'DELETE'
                        });
                        
                        if (response.ok) {
                            // é‡æ–°æ˜¾ç¤ºå·²å‚ä¸æ´»åŠ¨
                            showArtistActivities(artistId);
                        } else {
                            const result = await response.json();
                            alert('ç§»é™¤å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'));
                        }
                    }
                }
            } catch (error) {
                console.error('ç§»é™¤æ´»åŠ¨å¤±è´¥:', error);
                alert('ç§»é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }
    </script>
    
    <!-- é¡µè„šä¿¡æ¯ -->
    <style>
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            text-align: center;
            font-size: 0.9rem;
            color: #333;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }
    </style>
    <div class="footer">
        Project Development: Dog&Clip è”ç³»æ–¹å¼ï¼šã€å¾®ä¿¡ imdc9475ï¼›ç”µå­é‚®ç®± justin00654@163.comã€‘
    </div>
</body>
</html>
